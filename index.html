<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Soft Navigations</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <link href="https://www.w3.org/StyleSheets/TR/2021/cg-draft" rel="stylesheet">
  <meta content="Bikeshed version b06c00b8e, updated Tue Jul 11 13:41:16 2023 -0700" name="generator">
  <link href="https://wicg.github.io/soft-navigations/" rel="canonical">
  <meta content="07533ef0e29e81f38090df8f41a6e67bc9ed5595" name="document-revision">
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    white-space: pre;
    display: inline-block;
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled[role="button"] { cursor: pointer; }
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    white-space: pre;
    display: inline-block;
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled[role="button"] { cursor: pointer; }
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* Boilerplate: style-syntax-highlighting */

            pre.idl.highlight {
                background: var(--borderedblock-bg, var(--def-bg));
            }
            
</style>
<style>/* Boilerplate: style-syntax-highlighting */

code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */


@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Soft Navigations</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types#CG-DRAFT">Draft Community Group Report</a>, <time class="dt-updated" datetime="2023-11-29">29 November 2023</time></p>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://wicg.github.io/soft-navigations/">https://wicg.github.io/soft-navigations/</a>
     <dt>Test Suite:
     <dd><a href="https://github.com/web-platform-tests/wpt/tree/master/soft-navigation-heuristics">https://github.com/web-platform-tests/wpt/tree/master/soft-navigation-heuristics</a>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/WICG/soft-navigations/issues/">GitHub</a>
     <dd><a href="#issues-index">Inline In Spec</a>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard" data-editor-id="58673"><a class="p-name fn u-email email" href="mailto:yoav@yoav.ws">Yoav Weiss</a> (<a class="p-org org" href="https://google.com">Google</a>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> © 2023 the Contributors to the Soft Navigations Specification, published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>.
A human-readable <a href="http://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This document defines a heuristic that would enable browsers to report metrics related to Single Page Apps soft navigations.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This specification was published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a>.
  It is not a W3C Standard nor is it on the W3C Standards Track.

  Please note that under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a> there is a limited opt-out and other conditions apply.

  Learn more about <a href="http://www.w3.org/community/">W3C Community and Business Groups</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#sec-intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#sec-task-attribution-intro"><span class="secno">1.1</span> <span class="content">Task Attribution</span></a>
     </ol>
    <li><a href="#sec-interface"><span class="secno">2</span> <span class="content">The <code class="highlight">SoftNavigationEntry</code> interface</span></a>
    <li>
     <a href="#sec-algos"><span class="secno">3</span> <span class="content">Algorithms</span></a>
     <ol class="toc">
      <li><a href="#sec-entry"><span class="secno">3.1</span> <span class="content">Soft navigation entry</span></a>
      <li><a href="#sec-interaction"><span class="secno">3.2</span> <span class="content">Interaction</span></a>
      <li><a href="#sec-same-document-commit"><span class="secno">3.3</span> <span class="content">Same document commit</span></a>
      <li><a href="#sec-contentful-paint"><span class="secno">3.4</span> <span class="content">Contentful paint</span></a>
     </ol>
    <li>
     <a href="#sec-html"><span class="secno">4</span> <span class="content">HTML integration</span></a>
     <ol class="toc">
      <li><a href="#sec-html-document"><span class="secno">4.1</span> <span class="content">Document</span></a>
      <li><a href="#sec-html-history"><span class="secno">4.2</span> <span class="content">History</span></a>
      <li><a href="#sec-html-events"><span class="secno">4.3</span> <span class="content">Event dispatch</span></a>
      <li><a href="#sec-html-node"><span class="secno">4.4</span> <span class="content">Node</span></a>
     </ol>
    <li><a href="#sec-lcp-integration"><span class="secno">5</span> <span class="content">LCP integration</span></a>
    <li>
     <a href="#sec-task-attribution-algorithms"><span class="secno">6</span> <span class="content">Task Attibution Algorithms</span></a>
     <ol class="toc">
      <li><a href="#sec-task-scope"><span class="secno">6.1</span> <span class="content">Task scope</span></a>
      <li><a href="#sec-is-ancestor"><span class="secno">6.2</span> <span class="content">Is ancestor</span></a>
      <li>
       <a href="#sec-is-ancestor-in-set"><span class="secno">6.3</span> <span class="content">Is ancestor in set</span></a>
       <ol class="toc">
        <li><a href="#sec-current-task"><span class="secno">6.3.1</span> <span class="content">Get current task</span></a>
        <li><a href="#sec-current-task-id"><span class="secno">6.3.2</span> <span class="content">Get current task ID</span></a>
       </ol>
     </ol>
    <li>
     <a href="#sec-task-attribution-integration"><span class="secno">7</span> <span class="content">TaskAttribution integration</span></a>
     <ol class="toc">
      <li><a href="#sec-task"><span class="secno">7.1</span> <span class="content">Task additions</span></a>
      <li><a href="#sec-event-loop"><span class="secno">7.2</span> <span class="content">Event Loop additions</span></a>
      <li><a href="#sec-script"><span class="secno">7.3</span> <span class="content">Script execution</span></a>
      <li><a href="#sec-task-queueing"><span class="secno">7.4</span> <span class="content">Task queueing</span></a>
      <li><a href="#sec-timers"><span class="secno">7.5</span> <span class="content">Timers</span></a>
      <li><a href="#sec-callbacks"><span class="secno">7.6</span> <span class="content">Callbacks</span></a>
      <li>
       <a href="#sec-continuations"><span class="secno">7.7</span> <span class="content">Continuations</span></a>
       <ol class="toc">
        <li><a href="#sec-hostmakejobcallback"><span class="secno">7.7.1</span> <span class="content">HostMakeJobCallback ##{#sec-hostmakejobcallback}</span></a>
        <li><a href="#sec-hostcalljobcallback"><span class="secno">7.7.2</span> <span class="content">HostCallJobCallback</span></a>
       </ol>
      <li><a href="#sec-messageport"><span class="secno">7.8</span> <span class="content">MessagePorts</span></a>
      <li><a href="#sec-same-document-navigations"><span class="secno">7.9</span> <span class="content">Same-document navigations</span></a>
      <li><a href="#sec-view-transitions"><span class="secno">7.10</span> <span class="content">View transitions</span></a>
     </ol>
    <li><a href="#priv-sec"><span class="secno">8</span> <span class="content">Security &amp; privacy considerations</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="sec-intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#sec-intro"></a></h2>
   <div class="non-normative">
     <em>This section is non-normative.</em> 
    <p>A Single Page Application or an SPA is a web application that dynamically rewrites the DOM contents when the user navigates from one piece of content to another, instead of loading a new HTML page.
Development of SPAs has become a common  pattern on the web today. At the same time, browsers haven’t been able to measure performance metrics for such sites.
Specifically, JS-driven same-document navigations in SPAs have not been something that browsers detect, and hence went unmeasured.</p>
    <p>This specification outlines a heuristic to enable browsers to detect such navigations as Soft Navigations, and report them to the performance timeline and performance observers.</p>
   </div>
   <h3 class="heading settled" data-level="1.1" id="sec-task-attribution-intro"><span class="secno">1.1. </span><span class="content">Task Attribution</span><a class="self-link" href="#sec-task-attribution-intro"></a></h3>
   <div class="non-normative">
     The above heuristic relies on the ability to track task ancestory and to know that certain tasks were triggered by other tasks.
This specification also outlines a mechanism that would enable user agents to deduce that information, and use it in web exposed features, such as soft navigations. 
    <p>The user agent’s event loop is continuously running tasks, as well as microtasks.
Being able to keep track of which task initiated which can be valuable in multiple cases:</p>
    <ul>
     <li data-md>
      <p>Enable user agents to create heuristics that rely on causal link between one operation (e.g. a user initiated click event) and another (e,g. a DOM node append).</p>
     <li data-md>
      <p>Enable user agents to make prioritization (of tasks as well as resource loading) "inheritable", and e.g. ensure that low-priority scripts cannot queue high-priority tasks.</p>
     <li data-md>
      <p>Enable causal user activation delegation.</p>
     <li data-md>
      <p>Enable accumulating knowledge of resource loading dependency chains, and enable developers to draw insights from them.</p>
    </ul>
   </div>
   <h2 class="heading settled" data-level="2" id="sec-interface"><span class="secno">2. </span><span class="content">The <code class="highlight">SoftNavigationEntry</code> interface</span><a class="self-link" href="#sec-interface"></a></h2>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="softnavigationentry"><code class="highlight"><c- g>SoftNavigationEntry</c-></code></dfn> : <a data-link-type="idl-name" href="https://w3c.github.io/performance-timeline/#dom-performanceentry" id="ref-for-dom-performanceentry"><c- n>PerformanceEntry</c-></a> {
};
</pre>
   <h2 class="heading settled" data-level="3" id="sec-algos"><span class="secno">3. </span><span class="content">Algorithms</span><a class="self-link" href="#sec-algos"></a></h2>
   <div class="note" role="note">
     A Soft Navigation is a same document navigation which satisfies the following conditions: 
    <ul>
     <li data-md>
      <p>Its navigating task is a descendent of a user interaction task.</p>
     <li data-md>
      <p>There exists a DOM node append operation whose task is a descendent of the same user interaction task.</p>
    </ul>
   </div>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="check-soft-navigation">check soft navigation</dfn>, with a <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document">Document</a> <var>document</var>, run the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>interaction data</var> be the result of calling <a data-link-type="dfn" href="#get-current-interaction-data" id="ref-for-get-current-interaction-data">get current interaction data</a> with <var>document</var>.</p>
    <li data-md>
     <p>If <var>interaction data</var>’s <a data-link-type="dfn" href="#interaction-data-same-document-commit" id="ref-for-interaction-data-same-document-commit">same document commit</a> is false or <var>interaction data</var>’s <a data-link-type="dfn" href="#interaction-data-contentful-paint" id="ref-for-interaction-data-contentful-paint">contentful paint</a> is false, return.</p>
    <li data-md>
     <p>Let <var>global</var> be <var>document</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" id="ref-for-concept-relevant-global">relevant global object</a>.</p>
    <li data-md>
     <p>Let <var>url</var> be <var>interaction data</var>’s <a data-link-type="dfn" href="#interaction-data-url" id="ref-for-interaction-data-url">url</a>.</p>
    <li data-md>
     <p>Let <var>start time</var> be <var>interaction data</var>’s <a data-link-type="dfn" href="#interaction-data-start-time" id="ref-for-interaction-data-start-time">start time</a>.</p>
    <li data-md>
     <p>Let <var>entry</var> be the result of calling <a data-link-type="dfn" href="#create-a-soft-navigation-entry" id="ref-for-create-a-soft-navigation-entry">create a soft navigation entry</a> with <var>global</var>, <var>url</var>, and <var>start time</var>.</p>
    <li data-md>
     <p>Call <a data-link-type="dfn" href="#emit-soft-navigation-entry" id="ref-for-emit-soft-navigation-entry">emit soft navigation entry</a> with <var>global</var>, <var>entry</var>, <var>url</var> and <var>start time</var>.</p>
   </ol>
   <h3 class="heading settled" data-level="3.1" id="sec-entry"><span class="secno">3.1. </span><span class="content">Soft navigation entry</span><a class="self-link" href="#sec-entry"></a></h3>
    To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="create-a-soft-navigation-entry">create a soft navigation entry</dfn>, with a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object">global object</a> <var>global</var>, a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string">string</a> <var>url</var>, a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/hr-time/#dom-domhighrestimestamp" id="ref-for-dom-domhighrestimestamp">DOMHighResTimeStamp</a></code> <var>start time</var>, run the following steps: 
   <ol>
    <li data-md>
     <p>Let <var>entry</var> be a new <code class="idl"><a data-link-type="idl" href="#softnavigationentry" id="ref-for-softnavigationentry">SoftNavigationEntry</a></code> object in <var>global</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-global-object-realm" id="ref-for-concept-global-object-realm">realm</a>.</p>
    <li data-md>
     <p>Set <var>entry</var>’s <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/performance-timeline/#dom-performanceentry-name" id="ref-for-dom-performanceentry-name">name</a></code> to be <var>url</var>.</p>
    <li data-md>
     <p>Set <var>entry</var>’s <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/performance-timeline/#dom-performanceentry-entrytype" id="ref-for-dom-performanceentry-entrytype">entryType</a></code> to be "soft-navigation".</p>
    <li data-md>
     <p>Set <var>entry</var>’s <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/performance-timeline/#dom-performanceentry-starttime" id="ref-for-dom-performanceentry-starttime">startTime</a></code> to be <var>start time</var>.</p>
    <li data-md>
     <p>Let <var>now</var> be the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-current-high-resolution-time" id="ref-for-dfn-current-high-resolution-time">current high resolution time</a> given <var>global</var>;</p>
    <li data-md>
     <p>Let <var>duration</var> be the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration" id="ref-for-dfn-duration">duration</a> between <var>now</var> and <var>start time</var>.</p>
    <li data-md>
     <p>Set <var>entry</var>’s <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/performance-timeline/#dom-performanceentry-duration" id="ref-for-dom-performanceentry-duration">duration</a></code> to be <var>duration</var>.</p>
    <li data-md>
     <p>Return <var>entry</var>.</p>
   </ol>
   <p class="note" role="note"><span class="marker">Note:</span> <code class="highlight">id</code> and <code class="highlight">navigationId</code> are set further down, in <a data-link-type="dfn" href="https://w3c.github.io/performance-timeline/#dfn-queue-a-performanceentry" id="ref-for-dfn-queue-a-performanceentry">queue a PerformanceEntry</a>.</p>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="emit-soft-navigation-entry">emit soft navigation entry</dfn>, with a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object①">global object</a> <var>global</var>, and a <code class="idl"><a data-link-type="idl" href="#softnavigationentry" id="ref-for-softnavigationentry①">SoftNavigationEntry</a></code> <var>entry</var>, run the following steps:</p>
   <ol>
    <li data-md>
     <p><a data-link-type="dfn" href="https://w3c.github.io/performance-timeline/#dfn-queue-a-performanceentry" id="ref-for-dfn-queue-a-performanceentry①">Queue</a> <var>entry</var>.</p>
    <li data-md>
     <p>Add <var>entry</var> to <var>global</var>’s <a data-link-type="dfn" href="https://w3c.github.io/performance-timeline/#dfn-performance-entry-buffer" id="ref-for-dfn-performance-entry-buffer">performance entry buffer</a>.</p>
    <li data-md>
     <p>Set <var>global</var>’s <a data-link-type="dfn" href="https://w3c.github.io/largest-contentful-paint/#has-dispatched-scroll-event" id="ref-for-has-dispatched-scroll-event">has dispatched scroll event</a> and <a data-link-type="dfn" href="https://w3c.github.io/largest-contentful-paint/#has-dispatched-input-event" id="ref-for-has-dispatched-input-event">has dispatched input event</a> to false.</p>
    <li data-md>
     <p>Let <var>doc</var> be <var>global</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window" id="ref-for-concept-document-window">associated Document</a>.</p>
    <li data-md>
     <p>Set <var>doc</var>’s <a data-link-type="dfn" href="https://www.w3.org/TR/paint-timing/#previously-reported-paints" id="ref-for-previously-reported-paints">previously reported paints</a> to the empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set">set</a>.</p>
    <li data-md>
     <p>Set <var>doc</var>’s <a data-link-type="dfn" href="#document-interaction-task-id-to-interaction-data" id="ref-for-document-interaction-task-id-to-interaction-data">interaction task id to interaction data</a> to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map">map</a>.</p>
    <li data-md>
     <p>Set <var>doc</var>’s <a data-link-type="dfn" href="#document-task-id-to-interaction-task-id" id="ref-for-document-task-id-to-interaction-task-id">task id to interaction task id</a> to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map①">map</a>.</p>
    <li data-md>
     <p>Set <var>doc</var>’s <a data-link-type="dfn" href="#document-last-interaction-task-id" id="ref-for-document-last-interaction-task-id">last interaction task id</a> to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map②">map</a>.</p>
   </ol>
   <h3 class="heading settled" data-level="3.2" id="sec-interaction"><span class="secno">3.2. </span><span class="content">Interaction</span><a class="self-link" href="#sec-interaction"></a></h3>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="interaction-data">Interaction data</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct">struct</a> used to maintain the data required to detect a soft navigation from a single interaction.
It has the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item">items</a>:</p>
   <ul>
    <li data-md>
     <p><dfn class="dfn-paneled" data-dfn-for="interaction data" data-dfn-type="dfn" data-noexport id="interaction-data-url">url</dfn>, initially unset - Represents the soft navigation’s URL.</p>
    <li data-md>
     <p><dfn class="dfn-paneled" data-dfn-for="interaction data" data-dfn-type="dfn" data-noexport id="interaction-data-start-time">start time</dfn>, initially unset - Represents the user interaction event processing start time..</p>
    <li data-md>
     <p><dfn class="dfn-paneled" data-dfn-for="interaction data" data-dfn-type="dfn" data-noexport id="interaction-data-same-document-commit">same document commit</dfn> flag, initially unset - Indicates if a same-document commit happened as a result of the interaction.</p>
    <li data-md>
     <p><dfn class="dfn-paneled" data-dfn-for="interaction data" data-dfn-type="dfn" data-noexport id="interaction-data-contentful-paint">contentful paint</dfn> flag, initially unset  - Indicates that a contentful paint happened as a result of an element added by the interaction.</p>
   </ul>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="get-current-interaction-data">get current interaction data</dfn>, given a <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document①">Document</a> <var>document</var>, run the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>task id</var> be the result of calling <a data-link-type="dfn" href="#get-current-task-id" id="ref-for-get-current-task-id">get current task ID</a>.</p>
    <li data-md>
     <p>Let <var>interaction id</var> be <var>document</var>’s <a data-link-type="dfn" href="#document-task-id-to-interaction-task-id" id="ref-for-document-task-id-to-interaction-task-id①">task id to interaction task id</a>[<var>task id</var>] if it <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists">exists</a>, or <var>task id</var> otherwise.</p>
    <li data-md>
     <p>Assert that <var>document</var>’s <a data-link-type="dfn" href="#document-interaction-task-id-to-interaction-data" id="ref-for-document-interaction-task-id-to-interaction-data①">interaction task id to interaction data</a>[<var>interaction id</var>] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①">exists</a>.</p>
    <li data-md>
     <p>Return <var>document</var>’s <a data-link-type="dfn" href="#document-interaction-task-id-to-interaction-data" id="ref-for-document-interaction-task-id-to-interaction-data②">interaction task id to interaction data</a>[<var>interaction id</var>].</p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="handle-event-callback">handle event callback</dfn>, given an <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget">EventTarget</a></code> <var>target</var> and a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①">string</a> <var>event type</var>, run the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>document</var> be <var>target</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window" id="ref-for-concept-document-window①">associated Document</a>.</p>
    <li data-md>
     <p>If <var>document</var> is not a <a data-link-type="dfn" href="https://html.spec.whatwg.org/C#top-level-traversable" id="ref-for-top-level-traversable">top-level traversable</a>, return.</p>
    <li data-md>
     <p>Let <var>is click</var> be true if <var>event type</var> <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-equals" id="ref-for-concept-node-equals">equals</a> "click", and false otherwise.</p>
    <li data-md>
     <p>Let <var>is keyboard</var> be true if <var>target</var> is an {{HTMLBodyElement} and <var>event type</var> <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-equals" id="ref-for-concept-node-equals①">equals</a> "keydown", "keyup" or "keypress", and false otherwise.</p>
    <li data-md>
     <p>Let <var>is navigation</var> be true if <var>event type</var> <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-equals" id="ref-for-concept-node-equals②">equals</a> "navigate", and false otherwise.</p>
    <li data-md>
     <p>If neither <var>is click</var>, <var>is keyboard</var> nor <var>is navigation</var> is true, return.</p>
    <li data-md>
     <p>Let <var>task</var> be the result of calling <a data-link-type="dfn" href="#get-current-task-id" id="ref-for-get-current-task-id①">get current task ID</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append">Append</a> <var>task</var> to <var>document</var>’s <a data-link-type="dfn" href="#document-potential-soft-navigation-task-ids" id="ref-for-document-potential-soft-navigation-task-ids">potential soft navigation task ids</a>.</p>
    <li data-md>
     <p>Let <var>is new interaction</var> be true if <var>is click</var> is true or if <var>event type</var> <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-equals" id="ref-for-concept-node-equals③">equals</a> "keydown", and false otherwise.</p>
    <li data-md>
     <p>If <var>is new interaction</var> is false:</p>
     <ol>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set">Set</a> <var>document</var>’s <a data-link-type="dfn" href="#document-task-id-to-interaction-task-id" id="ref-for-document-task-id-to-interaction-task-id②">task id to interaction task id</a>[<var>task</var>] to <var>document</var>’s <a data-link-type="dfn" href="#document-last-interaction-task-id" id="ref-for-document-last-interaction-task-id①">last interaction task id</a>.</p>
      <li data-md>
       <p>Return null.</p>
     </ol>
    <li data-md>
     <p>If <var>document</var>’s <a data-link-type="dfn" href="#document-interaction-task-id-to-interaction-data" id="ref-for-document-interaction-task-id-to-interaction-data③">interaction task id to interaction data</a>[<var>task</var>] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists②">exists</a>, return null.</p>
    <li data-md>
     <p>Let <var>interaction data</var> be a new <a data-link-type="dfn" href="#interaction-data" id="ref-for-interaction-data">interaction data</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set①">Set</a> <var>document</var>’s <a data-link-type="dfn" href="#document-interaction-task-id-to-interaction-data" id="ref-for-document-interaction-task-id-to-interaction-data④">interaction task id to interaction data</a>[<var>task</var>] to <var>interaction data</var>.</p>
    <li data-md>
     <p>Return <var>interaction data</var>.</p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="terminate-event-callback-handling">terminate event callback handling</dfn>, given a <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document②">Document</a> <var>document</var> and null or <a data-link-type="dfn" href="#interaction-data" id="ref-for-interaction-data①">interaction data</a> <var>interaction data</var>, run the following steps:</p>
   <ol>
    <li data-md>
     <p>Set <var>interaction data</var>’s <a data-link-type="dfn" href="#interaction-data-start-time" id="ref-for-interaction-data-start-time①">start time</a> to the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-current-high-resolution-time" id="ref-for-dfn-current-high-resolution-time①">current high resolution time</a> given <var>document</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" id="ref-for-concept-relevant-global①">relevant global object</a>.</p>
   </ol>
   <h3 class="heading settled" data-level="3.3" id="sec-same-document-commit"><span class="secno">3.3. </span><span class="content">Same document commit</span><a class="self-link" href="#sec-same-document-commit"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="check-soft-navigation-same-document-commit">check soft navigation same document commit</dfn>, with <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string②">string</a> <var>url</var>, run the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>interaction data</var> be the result of calling <a data-link-type="dfn" href="#get-current-interaction-data" id="ref-for-get-current-interaction-data①">get current interaction data</a> with <var>document</var>.</p>
    <li data-md>
     <p>Let <var>is soft navigation same document commit</var> be the result of <a data-link-type="dfn" href="#check-ancestor-set-for-task" id="ref-for-check-ancestor-set-for-task">Check ancestor set for task</a> given <var>document</var>’s <a data-link-type="dfn" href="#document-potential-soft-navigation-task-ids" id="ref-for-document-potential-soft-navigation-task-ids①">potential soft navigation task ids</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set②">Set</a> <var>interaction data</var>’s <a data-link-type="dfn" href="#interaction-data-same-document-commit" id="ref-for-interaction-data-same-document-commit①">same document commit</a> to <var>is soft navigation same document commit</var>.</p>
    <li data-md>
     <p>if <var>is soft navigation same document commit</var> is true, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set③">set</a> <var>interaction data</var>’s <a data-link-type="dfn" href="#interaction-data-url" id="ref-for-interaction-data-url①">url</a> to <var>url</var>.</p>
    <li data-md>
     <p>Call <a data-link-type="dfn" href="#check-soft-navigation" id="ref-for-check-soft-navigation">check soft navigation</a> with <var>document</var>.</p>
   </ol>
   <h3 class="heading settled" data-level="3.4" id="sec-contentful-paint"><span class="secno">3.4. </span><span class="content">Contentful paint</span><a class="self-link" href="#sec-contentful-paint"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="check-soft-navigation-contentful-paint">check soft navigation contentful paint</dfn>, with <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-element" id="ref-for-concept-element">Element</a> <var>element</var> and <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document③">Document</a> <var>document</var>, run the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>interaction data</var> be the result of calling <a data-link-type="dfn" href="#get-current-interaction-data" id="ref-for-get-current-interaction-data②">get current interaction data</a> with <var>document</var>.</p>
    <li data-md>
     <p>If <var>element</var>’s <a data-link-type="dfn" href="#node-appended-by-soft-navigation" id="ref-for-node-appended-by-soft-navigation">appended by soft navigation</a> is true, set <var>interaction data</var>’s <a data-link-type="dfn" href="#interaction-data-contentful-paint" id="ref-for-interaction-data-contentful-paint①">contentful paint</a> to true.</p>
    <li data-md>
     <p>Call <a data-link-type="dfn" href="#check-soft-navigation" id="ref-for-check-soft-navigation①">check soft navigation</a> with <var>document</var>.</p>
   </ol>
   <h2 class="heading settled" data-level="4" id="sec-html"><span class="secno">4. </span><span class="content">HTML integration</span><a class="self-link" href="#sec-html"></a></h2>
   <h3 class="heading settled" data-level="4.1" id="sec-html-document"><span class="secno">4.1. </span><span class="content">Document</span><a class="self-link" href="#sec-html-document"></a></h3>
   <p>Each <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document④">document</a> has a <dfn class="dfn-paneled" data-dfn-for="document" data-dfn-type="dfn" data-noexport id="document-potential-soft-navigation-task-ids">potential soft navigation task ids</dfn>, a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set①">set</a> of <a data-link-type="dfn" href="#task-task-attribution-id" id="ref-for-task-task-attribution-id">task attribution id</a>s.</p>
   <p>Each <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document⑤">document</a> has a <dfn class="dfn-paneled" data-dfn-for="document" data-dfn-type="dfn" data-noexport id="document-interaction-task-id-to-interaction-data">interaction task id to interaction data</dfn>, a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map③">map</a>, initially empty.</p>
   <p>Each <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document⑥">document</a> has a <dfn class="dfn-paneled" data-dfn-for="document" data-dfn-type="dfn" data-noexport id="document-task-id-to-interaction-task-id">task id to interaction task id</dfn>, a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map④">map</a>, initially empty.</p>
   <p>Each <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document⑦">document</a> has a <dfn class="dfn-paneled" data-dfn-for="document" data-dfn-type="dfn" data-noexport id="document-last-interaction-task-id">last interaction task id</dfn>, a <a data-link-type="dfn" href="#task-task-attribution-id" id="ref-for-task-task-attribution-id①">task attribution id</a>.</p>
   <h3 class="heading settled" data-level="4.2" id="sec-html-history"><span class="secno">4.2. </span><span class="content">History</span><a class="self-link" href="#sec-html-history"></a></h3>
   <p>In <a data-link-type="dfn" href="https://html.spec.whatwg.org/C#update-document-for-history-step-application" id="ref-for-update-document-for-history-step-application">update document for history step application</a>, before 5.5.1 (if <code class="highlight">documentsEntryChanged</code> is true and if <code class="highlight">documentIsNew</code> is false),
call <a data-link-type="dfn" href="#check-soft-navigation-same-document-commit" id="ref-for-check-soft-navigation-same-document-commit">check soft navigation same document commit</a> with <var>entry</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/C#she-url" id="ref-for-she-url">url</a>.</p>
   <h3 class="heading settled" data-level="4.3" id="sec-html-events"><span class="secno">4.3. </span><span class="content">Event dispatch</span><a class="self-link" href="#sec-html-events"></a></h3>
   <p>At <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch">event dispatch</a>, after step 5.4 ("Let <code class="highlight">isActivationEvent</code> be true..."), add the following steps:</p>
   <ol>
    <li data-md>
     <p>If <var>event</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#dom-event-istrusted" id="ref-for-dom-event-istrusted">isTrusted</a> is true:</p>
     <ol>
      <li data-md>
       <p>Let <var>interaction data</var> be the result of calling <a data-link-type="dfn" href="#handle-event-callback" id="ref-for-handle-event-callback">handle event callback</a> with <var>target</var> and <var>event</var>’s type.</p>
     </ol>
   </ol>
   <p>At <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch①">event dispatch</a>, before step 6 (after callback invocation), add the following step:</p>
   <ol>
    <li data-md>
     <p>Call <a data-link-type="dfn" href="#terminate-event-callback-handling" id="ref-for-terminate-event-callback-handling">terminate event callback handling</a> with <var>document</var> and <var>interaction data</var>.</p>
   </ol>
   <h3 class="heading settled" data-level="4.4" id="sec-html-node"><span class="secno">4.4. </span><span class="content">Node</span><a class="self-link" href="#sec-html-node"></a></h3>
   <p>Each <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#boundary-point-node" id="ref-for-boundary-point-node">node</a> has a <dfn class="dfn-paneled" data-dfn-for="node" data-dfn-type="dfn" data-noexport id="node-appended-by-soft-navigation">appended by soft navigation</dfn> flag, initially unset.</p>
   <p>At <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-insert" id="ref-for-concept-node-insert">node insert</a>, add these initial steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>doc</var> be <var>parent</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-document" id="ref-for-concept-node-document">node document</a>.</p>
    <li data-md>
     <p>Let <var>is soft navigation append</var> be the result of running <a data-link-type="dfn" href="#check-ancestor-for-task" id="ref-for-check-ancestor-for-task">Check ancestor for task</a> with the <var>doc</var>’s <a data-link-type="dfn" href="#document-potential-soft-navigation-task-ids" id="ref-for-document-potential-soft-navigation-task-ids②">potential soft navigation task id</a> and the result of calling <a data-link-type="dfn" href="#get-current-task-id" id="ref-for-get-current-task-id②">get current task ID</a>.</p>
    <li data-md>
     <p>Set <var>node</var>’s <a data-link-type="dfn" href="#node-appended-by-soft-navigation" id="ref-for-node-appended-by-soft-navigation①">appended by soft navigation</a> to <var>is soft navigation append</var>.</p>
   </ol>
   <h2 class="heading settled" data-level="5" id="sec-lcp-integration"><span class="secno">5. </span><span class="content">LCP integration</span><a class="self-link" href="#sec-lcp-integration"></a></h2>
    In <a data-link-type="dfn" href="https://w3c.github.io/largest-contentful-paint/#potentially-add-a-largestcontentfulpaint-entry" id="ref-for-potentially-add-a-largestcontentfulpaint-entry">potentially add a LargestContentfulPaint entry</a>, add the following initial step: 
   <ol>
    <li data-md>
     <p>Call <a data-link-type="dfn" href="#check-soft-navigation-contentful-paint" id="ref-for-check-soft-navigation-contentful-paint">check soft navigation contentful paint</a> with <var>element</var> and <var>document</var>.</p>
   </ol>
   <h2 class="heading settled" data-level="6" id="sec-task-attribution-algorithms"><span class="secno">6. </span><span class="content">Task Attibution Algorithms</span><a class="self-link" href="#sec-task-attribution-algorithms"></a></h2>
   <p class="note" role="note"> The task attribution algorithms and their integration with HTML are likely to end up integrated into HTML directly.
Integration with other specifications is likely to end up in these specifications directly. </p>
   <p>The general principle behind task attribution is quite simple:</p>
   <ul>
    <li data-md>
     <p>Script execution creates a task scope</p>
    <li data-md>
     <p>Tasks and microtasks that are queued during a task scope’s lifetime are considered its descendents.</p>
    <li data-md>
     <p>Certain registered callbacks get an explicit parent task defined. (e.g. the task that registered the callback)</p>
   </ul>
   <p>Each task maintains a connection to its parent task, enabling an implicit data structure that enables querying a task to find if another, specific one is its ancestor.</p>
   <h3 class="heading settled" data-level="6.1" id="sec-task-scope"><span class="secno">6.1. </span><span class="content">Task scope</span><a class="self-link" href="#sec-task-scope"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="concept-task-scope">task scope</dfn> is formally defined as a structure.</p>
   <p>A <a data-link-type="dfn" href="#concept-task-scope" id="ref-for-concept-task-scope">task scope</a> has a <dfn class="dfn-paneled" data-dfn-for="task scope" data-dfn-type="dfn" data-noexport id="task-scope-task">task</dfn>, a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-task" id="ref-for-concept-task">task</a>.</p>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="create-a-task-scope">create a task scope</dfn>, given an optional <var>parent task</var>, a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-task" id="ref-for-concept-task①">task</a>, do the following:</p>
   <ol>
    <li data-md>
     <p>Let <var>task</var> be a new <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-task" id="ref-for-concept-task②">task</a>.</p>
    <li data-md>
     <p>Set <var>task</var>’s <a data-link-type="dfn" href="#task-task-attribution-id" id="ref-for-task-task-attribution-id②">task attribution ID</a> to an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined">implementation-defined</a> unique value.</p>
    <li data-md>
     <p>If <var>parent task</var> is provided, set <var>task</var>’s <a data-link-type="dfn" href="#task-parent-task" id="ref-for-task-parent-task">parent task</a> to <var>parent task</var>.</p>
    <li data-md>
     <p>Let <var>scope</var> be a new <a data-link-type="dfn" href="#concept-task-scope" id="ref-for-concept-task-scope①">task scope</a>.</p>
    <li data-md>
     <p>Set <var>scope</var>’s <a data-link-type="dfn" href="#task-scope-task" id="ref-for-task-scope-task">task</a> to <var>task</var>.</p>
    <li data-md>
     <p>Push <var>scope</var> to the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-agent" id="ref-for-relevant-agent">relevant agent</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-agent-event-loop" id="ref-for-concept-agent-event-loop">event loop</a>'s <a data-link-type="dfn" href="#task-scope-stack" id="ref-for-task-scope-stack">task scope stack</a>.</p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="tear-down-a-task-scope">tear down a task scope</dfn>, do the following:</p>
   <ol>
    <li data-md>
     <p>Pop <var>scope</var> from the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-agent" id="ref-for-relevant-agent①">relevant agent</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-agent-event-loop" id="ref-for-concept-agent-event-loop①">event loop</a>'s <a data-link-type="dfn" href="#task-scope-stack" id="ref-for-task-scope-stack①">task scope stack</a></p>
   </ol>
   <h3 class="heading settled" data-level="6.2" id="sec-is-ancestor"><span class="secno">6.2. </span><span class="content">Is ancestor</span><a class="self-link" href="#sec-is-ancestor"></a></h3>
    To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="check-ancestor-for-task">check ancestor for task</dfn>, given <var>ancestor id</var>, a <a data-link-type="dfn" href="#task-task-attribution-id" id="ref-for-task-task-attribution-id③">task attribution ID</a>, run the following: 
   <ol>
    <li data-md>
     <p>Let <var>task</var> be the result of <a data-link-type="dfn" href="#get-current-task" id="ref-for-get-current-task">get current task</a>.</p>
    <li data-md>
     <p>While true:</p>
     <ol>
      <li data-md>
       <p>Let <var>id</var> be<var>task</var>’s <a data-link-type="dfn" href="#task-task-attribution-id" id="ref-for-task-task-attribution-id④">task attribution ID</a>.</p>
      <li data-md>
       <p>If <var>id</var> is unset, return false.</p>
      <li data-md>
       <p>If <var>id</var> equals <var>ancestor id</var>, return true.</p>
      <li data-md>
       <p>Set <var>task</var> to <var>task</var>’s <a data-link-type="dfn" href="#task-parent-task" id="ref-for-task-parent-task①">parent task</a>.</p>
     </ol>
   </ol>
   <h3 class="heading settled" data-level="6.3" id="sec-is-ancestor-in-set"><span class="secno">6.3. </span><span class="content">Is ancestor in set</span><a class="self-link" href="#sec-is-ancestor-in-set"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="check-ancestor-set-for-task">check ancestor set for task</dfn>, given <var>ancestor id set</var>, a <a data-link-type="dfn" href="#task-task-attribution-id" id="ref-for-task-task-attribution-id⑤">task attribution ID</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set②">set</a>, run the following:</p>
   <ol>
    <li data-md>
     <p>Let <var>task</var> be the result of <a data-link-type="dfn" href="#get-current-task" id="ref-for-get-current-task①">get current task</a>.</p>
    <li data-md>
     <p>While true:</p>
     <ol>
      <li data-md>
       <p>Let <var>id</var> be <var>task</var>’s <a data-link-type="dfn" href="#task-task-attribution-id" id="ref-for-task-task-attribution-id⑥">task attribution ID</a> if <var>task</var> is set, or be unset otherwise.</p>
      <li data-md>
       <p>If <var>id</var> is unset, return false.</p>
      <li data-md>
       <p>If <var>ancestor id set</var> <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#header-list-contains" id="ref-for-header-list-contains">contains</a> <var>id</var>, return true.</p>
      <li data-md>
       <p>Set <var>task</var> to <var>task</var>’s <a data-link-type="dfn" href="#task-parent-task" id="ref-for-task-parent-task②">parent task</a>.</p>
     </ol>
   </ol>
   <h4 class="heading settled" data-level="6.3.1" id="sec-current-task"><span class="secno">6.3.1. </span><span class="content">Get current task</span><a class="self-link" href="#sec-current-task"></a></h4>
    To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="get-current-task">get current task</dfn>, run the following steps: 
   <ol>
    <li data-md>
     <p>Let <var>event loop</var> be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-agent" id="ref-for-relevant-agent②">relevant agent</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-agent-event-loop" id="ref-for-concept-agent-event-loop②">event loop</a>.</p>
    <li data-md>
     <p>Let <var>scope</var> be the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#stack-peek" id="ref-for-stack-peek">peeking</a> into the <var>event loop</var>’s <a data-link-type="dfn" href="#task-scope-stack" id="ref-for-task-scope-stack②">task scope stack</a>.</p>
    <li data-md>
     <p>Return <var>scope</var>’s <a data-link-type="dfn" href="#task-scope-task" id="ref-for-task-scope-task①">task</a>.</p>
   </ol>
   <h4 class="heading settled" data-level="6.3.2" id="sec-current-task-id"><span class="secno">6.3.2. </span><span class="content">Get current task ID</span><a class="self-link" href="#sec-current-task-id"></a></h4>
    To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="get-current-task-id">get current task id</dfn>, run the following steps: 
   <ol>
    <li data-md>
     <p>Let <var>task</var> be the result of <a data-link-type="dfn" href="#get-current-task" id="ref-for-get-current-task②">getting current task</a>.</p>
    <li data-md>
     <p>Return <var>task</var>’s <a data-link-type="dfn" href="#task-task-attribution-id" id="ref-for-task-task-attribution-id⑦">task attribution ID</a>.</p>
   </ol>
   <h2 class="heading settled" data-level="7" id="sec-task-attribution-integration"><span class="secno">7. </span><span class="content">TaskAttribution integration</span><a class="self-link" href="#sec-task-attribution-integration"></a></h2>
   <p class="note" role="note"><span class="marker">Note:</span> Most of this integration is with the HTML spec, although some of it is with WebIDL and CSS ViewTransitions.
The desired end state would be for these integrations to be embedded in the relevant specifications.</p>
   <h3 class="heading settled" data-level="7.1" id="sec-task"><span class="secno">7.1. </span><span class="content">Task additions</span><a class="self-link" href="#sec-task"></a></h3>
   <p>A <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-task" id="ref-for-concept-task③">task</a> has a <dfn class="dfn-paneled" data-dfn-for="task" data-dfn-type="dfn" data-noexport id="task-task-attribution-id">task attribution ID</dfn>, an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined①">implementation-defined</a> value,
representing a unique identifier. It is initially unset.</p>
   <p>A <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-task" id="ref-for-concept-task④">task</a> has a <dfn class="dfn-paneled" data-dfn-for="task" data-dfn-type="dfn" data-noexport id="task-parent-task">parent task</dfn>, a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-task" id="ref-for-concept-task⑤">task</a>, initially unset.</p>
   <h3 class="heading settled" data-level="7.2" id="sec-event-loop"><span class="secno">7.2. </span><span class="content">Event Loop additions</span><a class="self-link" href="#sec-event-loop"></a></h3>
    Each <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop" id="ref-for-event-loop">event loop</a> has a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="task-scope-stack">task scope stack</dfn>, a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#stack" id="ref-for-stack">stack</a> of <a data-link-type="dfn" href="#concept-task-scope" id="ref-for-concept-task-scope②">task scopes</a>. 
   <h3 class="heading settled" data-level="7.3" id="sec-script"><span class="secno">7.3. </span><span class="content">Script execution</span><a class="self-link" href="#sec-script"></a></h3>
   <p>A <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-script" id="ref-for-concept-script">script</a> element has a <dfn class="dfn-paneled" data-dfn-for="script" data-dfn-type="dfn" data-noexport id="script-parent-task">parent task</dfn> <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-task" id="ref-for-concept-task⑥">task</a>, initially unset.</p>
   <p>In <a data-link-type="dfn" href="https://html.spec.whatwg.org/C#prepare-the-script-element" id="ref-for-prepare-the-script-element">prepare the script element</a>, add an initial step:</p>
   <ol>
    <li data-md>
     <p>Set <var>el</var>’s <a data-link-type="dfn" href="#script-parent-task" id="ref-for-script-parent-task">parent task</a> to the result of running <a data-link-type="dfn" href="#get-current-task" id="ref-for-get-current-task③">get current task</a>.</p>
   </ol>
   <p class="note" role="note"><span class="marker">Note:</span> The parent task ensures that task creation through the injection of scripts can be properly attributed.</p>
   <p>In <a data-link-type="dfn" href="https://html.spec.whatwg.org/C#execute-the-script-element" id="ref-for-execute-the-script-element">Execute the script element</a>, add initial steps:</p>
   <ol>
    <li data-md>
     <p><a data-link-type="dfn" href="#create-a-task-scope" id="ref-for-create-a-task-scope">Create a task scope</a> <var>el</var>’s <a data-link-type="dfn" href="#script-parent-task" id="ref-for-script-parent-task①">parent task</a>.</p>
   </ol>
   <p>Also, add a terminating step:</p>
   <ol>
    <li data-md>
     <p><a data-link-type="dfn" href="#tear-down-a-task-scope" id="ref-for-tear-down-a-task-scope">Tear down a task scope</a></p>
   </ol>
   <h3 class="heading settled" data-level="7.4" id="sec-task-queueing"><span class="secno">7.4. </span><span class="content">Task queueing</span><a class="self-link" href="#sec-task-queueing"></a></h3>
    In <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-task">queue a task</a>: 
   <p>Add these steps after step 3, "Let task be a new task":</p>
   <ol>
    <li data-md>
     <p>Set <var>task</var>’s <a data-link-type="dfn" href="#task-parent-task" id="ref-for-task-parent-task③">parent task</a> to the result of <a data-link-type="dfn" href="#get-current-task" id="ref-for-get-current-task④">getting current task</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="#create-a-task-scope" id="ref-for-create-a-task-scope①">Create a task scope</a> with <var>task</var>.</p>
   </ol>
   <p>Add a terminating step:</p>
   <ol>
    <li data-md>
     <p><a data-link-type="dfn" href="#tear-down-a-task-scope" id="ref-for-tear-down-a-task-scope①">Tear down a task scope</a></p>
   </ol>
   <h3 class="heading settled" data-level="7.5" id="sec-timers"><span class="secno">7.5. </span><span class="content">Timers</span><a class="self-link" href="#sec-timers"></a></h3>
    In <a data-link-type="dfn" href="https://html.spec.whatwg.org/C#timer-initialisation-steps" id="ref-for-timer-initialisation-steps">timer initialisation steps</a>, before step 8, add the following steps: 
   <ol>
    <li data-md>
     <p>Let <var>parent task</var> be the result of <a data-link-type="dfn" href="#get-current-task" id="ref-for-get-current-task⑤">getting current task</a>.</p>
    <li data-md>
     <p>If <var>handler</var> is a Function, set <var>handler</var>’s <a data-link-type="dfn" href="#callback-function-parent-task" id="ref-for-callback-function-parent-task">parent task</a> to <var>parent task</var>.</p>
    <li data-md>
     <p>Otherwise, <a data-link-type="dfn" href="#create-a-task-scope" id="ref-for-create-a-task-scope②">create a task scope</a> with <var>parent task</var>..</p>
   </ol>
   <p>TODO: need a teardown here for the second case</p>
   <h3 class="heading settled" data-level="7.6" id="sec-callbacks"><span class="secno">7.6. </span><span class="content">Callbacks</span><a class="self-link" href="#sec-callbacks"></a></h3>
   <p>A <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-callback-function" id="ref-for-dfn-callback-function">callback function</a> has a <dfn class="dfn-paneled" data-dfn-for="callback function" data-dfn-type="dfn" data-noexport id="callback-function-parent-task">parent task</dfn>, a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-task" id="ref-for-concept-task⑦">task</a>, initially unset.</p>
   <p>In <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#invoke-a-callback-function" id="ref-for-invoke-a-callback-function">invoke a callback function</a>, add the following steps after step 7:</p>
   <ol>
    <li data-md>
     <p>Let <var>task</var> be <var>callback</var>’s <a data-link-type="dfn" href="#callback-function-parent-task" id="ref-for-callback-function-parent-task①">parent task</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="#create-a-task-scope" id="ref-for-create-a-task-scope③">create a task scope</a> with <var>task</var> if set, and with nothing otherwise.</p>
   </ol>
   <p>Add a terminating step:</p>
   <ol>
    <li data-md>
     <p><a data-link-type="dfn" href="#tear-down-a-task-scope" id="ref-for-tear-down-a-task-scope②">Tear down a task scope</a></p>
   </ol>
   <p>In <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#call-a-user-objects-operation" id="ref-for-call-a-user-objects-operation">call a user object’s operation</a>, add the following steps after step 7:</p>
   <ol>
    <li data-md>
     <p>Let <var>task</var> be <var>value</var>’s <a data-link-type="dfn" href="#callback-function-parent-task" id="ref-for-callback-function-parent-task②">parent task</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="#create-a-task-scope" id="ref-for-create-a-task-scope④">create a task scope</a> with <var>task</var> if set, and with nothing otherwise.</p>
   </ol>
   <p>Add a terminating step before returning:</p>
   <ol>
    <li data-md>
     <p><a data-link-type="dfn" href="#tear-down-a-task-scope" id="ref-for-tear-down-a-task-scope③">Tear down a task scope</a></p>
   </ol>
   <p class="issue" id="issue-eae2392e"><a class="self-link" href="#issue-eae2392e"></a> May be this should be called in "prepare to run a callback"/"clean up after running a callback", but we’d need to pipe in the callback for that.</p>
   <p class="issue" id="issue-83823d90"><a class="self-link" href="#issue-83823d90"></a> May be we need to define registration semantics for everything that doesn’t need anything more specific.</p>
   <p>In <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#clean-up-after-running-a-callback" id="ref-for-clean-up-after-running-a-callback">clean up after running a callback</a>, add the following step:</p>
   <ol>
    <li data-md>
     <p><a data-link-type="dfn" href="#tear-down-a-task-scope" id="ref-for-tear-down-a-task-scope④">Tear down a task scope</a>.</p>
   </ol>
   <h3 class="heading settled" data-level="7.7" id="sec-continuations"><span class="secno">7.7. </span><span class="content">Continuations</span><a class="self-link" href="#sec-continuations"></a></h3>
   <h4 class="heading settled" data-level="7.7.1" id="sec-hostmakejobcallback"><span class="secno">7.7.1. </span><span class="content">HostMakeJobCallback ##{#sec-hostmakejobcallback}</span><a class="self-link" href="#sec-hostmakejobcallback"></a></h4>
    In <a data-link-type="dfn" href="https://html.spec.whatwg.org/C#hostmakejobcallback" id="ref-for-hostmakejobcallback">HostMakeJobCallback</a>, add the following steps: 
   <ol>
    <li data-md>
     <p>Let <var>task</var> be the result of <a data-link-type="dfn" href="#get-current-task" id="ref-for-get-current-task⑥">getting current task</a>.</p>
    <li data-md>
     <p>Let <var>callable</var>’s [=callback function/parent task|  be <var>task</var>.</p>
   </ol>
   <p class="note" role="note"><span class="marker">Note:</span> This is needed to ensure the current task is registered on the promise continuations when they are created.</p>
   <p>TODO: Figure out if we need to do something in particular with the FinalizationRegsitry.</p>
   <h4 class="heading settled" data-level="7.7.2" id="sec-hostcalljobcallback"><span class="secno">7.7.2. </span><span class="content">HostCallJobCallback</span><a class="self-link" href="#sec-hostcalljobcallback"></a></h4>
   <p>In <a data-link-type="dfn" href="https://html.spec.whatwg.org/C#hostcalljobcallback" id="ref-for-hostcalljobcallback">HostCallJobCallback</a>, add initial steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>task</var> be <var>callback</var>’s <a data-link-type="dfn" href="#callback-function-parent-task" id="ref-for-callback-function-parent-task③">parent task</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="#create-a-task-scope" id="ref-for-create-a-task-scope⑤">create a task scope</a> with <var>task</var> if set, and with nothing otherwise.</p>
   </ol>
   <p>Add a terminating step:</p>
   <ol>
    <li data-md>
     <p><a data-link-type="dfn" href="#tear-down-a-task-scope" id="ref-for-tear-down-a-task-scope⑤">Tear down a task scope</a></p>
   </ol>
   <p class="note" role="note"> The above is called when promise continuations are run.
That does not match Chromium where Blink is not notified when promise continuations are run inside
of V8, and hence is subtly different than what’s implemented in Chromium.
In Chromium the the continuation task overrides the task stack, where here it pushes a new child
task of itself onto that stack.  At the same time, there shouldn’t be any functional differences
between the two. </p>
   <h3 class="heading settled" data-level="7.8" id="sec-messageport"><span class="secno">7.8. </span><span class="content">MessagePorts</span><a class="self-link" href="#sec-messageport"></a></h3>
   <p class="note" role="note"> For message ports, we want the <code class="highlight">message</code> event callback task to have the task that initiated the <code class="highlight">postMessage</code> as its parent. </p>
   <p>In <a data-link-type="dfn" href="https://html.spec.whatwg.org/C#message-port-post-message-steps" id="ref-for-message-port-post-message-steps">message port post message steps</a>, add the following steps.</p>
   <p>Before step 7, which adds a task, add the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>parent task</var> be the result of <a data-link-type="dfn" href="#get-current-task" id="ref-for-get-current-task⑦">getting current task</a>.</p>
   </ol>
   <p>In step 7.3, which fires the <code class="highlight">messageerror</code> event, call <a data-link-type="dfn" href="#create-a-task-scope" id="ref-for-create-a-task-scope⑥">create a task scope</a> with <var>parent task</var> before firing the event, and <a data-link-type="dfn" href="#tear-down-a-task-scope" id="ref-for-tear-down-a-task-scope⑥">tear down a task scope</a> after firing it..</p>
   <p>Before step 7.6, which fires the <code class="highlight">message</code> event, add the following steps:</p>
   <ol>
    <li data-md>
     <p>Call <a data-link-type="dfn" href="#create-a-task-scope" id="ref-for-create-a-task-scope⑦">create a task scope</a> with <var>parent task</var>.</p>
   </ol>
   <p>After step 7.6, add the following steps:</p>
   <ol>
    <li data-md>
     <p>Call <a data-link-type="dfn" href="#tear-down-a-task-scope" id="ref-for-tear-down-a-task-scope⑦">tear down a task scope</a>.</p>
   </ol>
   <h3 class="heading settled" data-level="7.9" id="sec-same-document-navigations"><span class="secno">7.9. </span><span class="content">Same-document navigations</span><a class="self-link" href="#sec-same-document-navigations"></a></h3>
    A <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#traversable-navigable" id="ref-for-traversable-navigable">traversable navigable</a> has a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="navigation-task">navigation task</dfn>, a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-task" id="ref-for-concept-task⑧">task</a>, initially unset. 
   <p>In <a data-link-type="dfn" href="https://html.spec.whatwg.org/C#tn-append-session-history-traversal-steps" id="ref-for-tn-append-session-history-traversal-steps">append session history traversal steps</a>, also set <var>traversable</var>’s <a data-link-type="dfn" href="#navigation-task" id="ref-for-navigation-task">navigation task</a> to the result of <a data-link-type="dfn" href="#get-current-task" id="ref-for-get-current-task⑧">getting current task</a>.</p>
   <p>In <a data-link-type="dfn" href="https://html.spec.whatwg.org/C#tn-append-session-history-synchronous-navigation-steps" id="ref-for-tn-append-session-history-synchronous-navigation-steps">append session history synchronous navigation steps</a>, also set <var>traversable</var>’s <a data-link-type="dfn" href="#navigation-task" id="ref-for-navigation-task①">navigation task</a> to the result of <a data-link-type="dfn" href="#get-current-task" id="ref-for-get-current-task⑨">getting current task</a>.</p>
   <p>In <a data-link-type="dfn" href="https://html.spec.whatwg.org/C#apply-the-history-step" id="ref-for-apply-the-history-step">apply the history step</a> in step 14.11.2, pass the navigable’s task to <a data-link-type="dfn" href="https://html.spec.whatwg.org/C#update-document-for-history-step-application" id="ref-for-update-document-for-history-step-application①">update document for history step application</a>.</p>
   <p>In <a data-link-type="dfn" href="https://html.spec.whatwg.org/C#navigate-fragid" id="ref-for-navigate-fragid">navigate to a fragment</a> step 14, pass the result of <a data-link-type="dfn" href="#get-current-task" id="ref-for-get-current-task①⓪">getting current task</a>.</p>
   <p>In <a data-link-type="dfn" href="https://html.spec.whatwg.org/C#update-document-for-history-step-application" id="ref-for-update-document-for-history-step-application②">update document for history step application</a>, before firing the popstate event in step 5.5.2, <a data-link-type="dfn" href="#create-a-task-scope" id="ref-for-create-a-task-scope⑧">create a task scope</a> with <var>task</var>. <a data-link-type="dfn" href="#tear-down-a-task-scope" id="ref-for-tear-down-a-task-scope⑧">tear down a task scope</a> after firing the event.</p>
   <p>TODO: more formally define the above.</p>
   <h3 class="heading settled" data-level="7.10" id="sec-view-transitions"><span class="secno">7.10. </span><span class="content">View transitions</span><a class="self-link" href="#sec-view-transitions"></a></h3>
   <p>In <a data-link-type="dfn" href="https://www.w3.org/TR/css-view-transitions-1/#dom-document-startviewtransition" id="ref-for-dom-document-startviewtransition">startViewTransition()</a> add the following initial steps:</p>
   <ol>
    <li data-md>
     <p>Set updateCallback’s <a data-link-type="dfn" href="#callback-function-parent-task" id="ref-for-callback-function-parent-task④">parent task</a> to the result of <a data-link-type="dfn" href="#get-current-task" id="ref-for-get-current-task①①">getting current task</a>.</p>
   </ol>
   <h2 class="heading settled" data-level="8" id="priv-sec"><span class="secno">8. </span><span class="content">Security &amp; privacy considerations</span><a class="self-link" href="#priv-sec"></a></h2>
    Exposing Soft Navigations to the performance timeline doesn’t have security and privacy implications on its own.
However, reseting the various paint timing entries as a result of a detected soft navigation can have implications,
especially before <a href="https://github.com/kyraseevers/Partitioning-visited-links-history">visited links are partitioned</a>.
As such, exposing such paint operations without partitioning the :visited cache needs to only be done after careful
 analysis of the paint operations in question, to make sure they don’t expose the user’s history across origins. 
   <p>Task Attribution as infrastructure doesn’t directly expose any data to the web, so it doesn’t have any privacy and security implications.
Web exposed specifications that rely on this infrastructure could have such implications. As such, they need to be
individually examined and have those implications outlined.</p>
  </main>
<script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#node-appended-by-soft-navigation">appended by soft navigation</a><span>, in § 4.4</span>
   <li><a href="#check-ancestor-for-task">check ancestor for task</a><span>, in § 6.2</span>
   <li><a href="#check-ancestor-set-for-task">check ancestor set for task</a><span>, in § 6.3</span>
   <li><a href="#check-soft-navigation">check soft navigation</a><span>, in § 3</span>
   <li><a href="#check-soft-navigation-contentful-paint">check soft navigation contentful paint</a><span>, in § 3.4</span>
   <li><a href="#check-soft-navigation-same-document-commit">check soft navigation same document commit</a><span>, in § 3.3</span>
   <li><a href="#interaction-data-contentful-paint">contentful paint</a><span>, in § 3.2</span>
   <li><a href="#create-a-soft-navigation-entry">create a soft navigation entry</a><span>, in § 3.1</span>
   <li><a href="#create-a-task-scope">create a task scope</a><span>, in § 6.1</span>
   <li><a href="#emit-soft-navigation-entry">emit soft navigation entry</a><span>, in § 3.1</span>
   <li><a href="#get-current-interaction-data">get current interaction data</a><span>, in § 3.2</span>
   <li><a href="#get-current-task">get current task</a><span>, in § 6.3.1</span>
   <li><a href="#get-current-task-id">get current task id</a><span>, in § 6.3.2</span>
   <li><a href="#handle-event-callback">handle event callback</a><span>, in § 3.2</span>
   <li><a href="#interaction-data">Interaction data</a><span>, in § 3.2</span>
   <li><a href="#document-interaction-task-id-to-interaction-data">interaction task id to interaction data</a><span>, in § 4.1</span>
   <li><a href="#document-last-interaction-task-id">last interaction task id</a><span>, in § 4.1</span>
   <li><a href="#navigation-task">navigation task</a><span>, in § 7.9</span>
   <li>
    parent task
    <ul>
     <li><a href="#callback-function-parent-task">dfn for callback function</a><span>, in § 7.6</span>
     <li><a href="#script-parent-task">dfn for script</a><span>, in § 7.3</span>
     <li><a href="#task-parent-task">dfn for task</a><span>, in § 7.1</span>
    </ul>
   <li><a href="#document-potential-soft-navigation-task-ids">potential soft navigation task ids</a><span>, in § 4.1</span>
   <li><a href="#interaction-data-same-document-commit">same document commit</a><span>, in § 3.2</span>
   <li><a href="#softnavigationentry">SoftNavigationEntry</a><span>, in § 2</span>
   <li><a href="#interaction-data-start-time">start time</a><span>, in § 3.2</span>
   <li><a href="#task-scope-task">task</a><span>, in § 6.1</span>
   <li><a href="#task-task-attribution-id">task attribution ID</a><span>, in § 7.1</span>
   <li><a href="#document-task-id-to-interaction-task-id">task id to interaction task id</a><span>, in § 4.1</span>
   <li><a href="#concept-task-scope">task scope</a><span>, in § 6.1</span>
   <li><a href="#task-scope-stack">task scope stack</a><span>, in § 7.2</span>
   <li><a href="#tear-down-a-task-scope">tear down a task scope</a><span>, in § 6.1</span>
   <li><a href="#terminate-event-callback-handling">terminate event callback handling</a><span>, in § 3.2</span>
   <li><a href="#interaction-data-url">url</a><span>, in § 3.2</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="f0a4a2c5">has dispatched input event</span>
     <li><span class="dfn-paneled" id="ea3a4c2f">has dispatched scroll event</span>
     <li><span class="dfn-paneled" id="976def1b">previously reported paints</span>
     <li><span class="dfn-paneled" id="bb2c4ef9">startviewtransition()</span>
    </ul>
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="2bc0cdf4">EventTarget</span>
     <li><span class="dfn-paneled" id="a973e0fe">document</span>
     <li><span class="dfn-paneled" id="27d9b7ea">element</span>
     <li><span class="dfn-paneled" id="e9486b7f">equals</span>
     <li><span class="dfn-paneled" id="4523ab1a">event dispatch</span>
     <li><span class="dfn-paneled" id="b87df86e">istrusted</span>
     <li><span class="dfn-paneled" id="d462b34f">node</span>
     <li><span class="dfn-paneled" id="5216e1a0">node document</span>
     <li><span class="dfn-paneled" id="59bfea49">node insert</span>
    </ul>
   <li>
    <a data-link-type="biblio">[FETCH]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="d5434eef">contains</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HR-TIME-3]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="0e9f636b">DOMHighResTimeStamp</span>
     <li><span class="dfn-paneled" id="7e7cc1d8">current high resolution time</span>
     <li><span class="dfn-paneled" id="4b2c8c72">duration</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="af257a63">append session history synchronous navigation steps</span>
     <li><span class="dfn-paneled" id="e2ab0b9e">append session history traversal steps</span>
     <li><span class="dfn-paneled" id="019c28e2">apply the history step</span>
     <li><span class="dfn-paneled" id="3349d69f">associated document</span>
     <li><span class="dfn-paneled" id="d5ac3b38">clean up after running a callback</span>
     <li><span class="dfn-paneled" id="c6d19e56">event loop</span>
     <li><span class="dfn-paneled" id="b78d6a64">event loop <small>(for agent)</small></span>
     <li><span class="dfn-paneled" id="9ed0e01d">execute the script element</span>
     <li><span class="dfn-paneled" id="4b6086d7">global object</span>
     <li><span class="dfn-paneled" id="355696eb">hostcalljobcallback</span>
     <li><span class="dfn-paneled" id="d0010562">hostmakejobcallback</span>
     <li><span class="dfn-paneled" id="132c94e7">message port post message steps</span>
     <li><span class="dfn-paneled" id="887585a1">navigate to a fragment</span>
     <li><span class="dfn-paneled" id="5e31523c">prepare the script element</span>
     <li><span class="dfn-paneled" id="9a517a7d">queue a task</span>
     <li><span class="dfn-paneled" id="b75a7d23">realm</span>
     <li><span class="dfn-paneled" id="d8049b98">relevant agent</span>
     <li><span class="dfn-paneled" id="e99bd18e">relevant global object</span>
     <li><span class="dfn-paneled" id="dd6462cb">script</span>
     <li><span class="dfn-paneled" id="770d6174">session history entry url</span>
     <li><span class="dfn-paneled" id="e270bd2a">task</span>
     <li><span class="dfn-paneled" id="32301e7b">timer initialisation steps</span>
     <li><span class="dfn-paneled" id="5fd199e1">top-level traversable</span>
     <li><span class="dfn-paneled" id="d0c1b934">traversable navigable</span>
     <li><span class="dfn-paneled" id="d0c5bc48">update document for history step application</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="a3b18719">append</span>
     <li><span class="dfn-paneled" id="1243a891">exist</span>
     <li><span class="dfn-paneled" id="860300d4">implementation-defined</span>
     <li><span class="dfn-paneled" id="c88f3887">item</span>
     <li><span class="dfn-paneled" id="3fca5a9e">map</span>
     <li><span class="dfn-paneled" id="a5ad1660">peek</span>
     <li><span class="dfn-paneled" id="15e48c39">set</span>
     <li><span class="dfn-paneled" id="0e6b2056">set <small>(for map)</small></span>
     <li><span class="dfn-paneled" id="ceacaa1c">stack</span>
     <li><span class="dfn-paneled" id="0698d556">string</span>
     <li><span class="dfn-paneled" id="984221ca">struct</span>
    </ul>
   <li>
    <a data-link-type="biblio">[LARGEST-CONTENTFUL-PAINT]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="984cff1a">potentially add a largestcontentfulpaint entry</span>
    </ul>
   <li>
    <a data-link-type="biblio">[PERFORMANCE-TIMELINE]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="a7f8f241">PerformanceEntry</span>
     <li><span class="dfn-paneled" id="fabd3046">duration</span>
     <li><span class="dfn-paneled" id="08a90f22">entryType</span>
     <li><span class="dfn-paneled" id="09c54b53">name</span>
     <li><span class="dfn-paneled" id="d52ccb4e">performance entry buffer</span>
     <li><span class="dfn-paneled" id="a9ea380f">queue a performanceentry</span>
     <li><span class="dfn-paneled" id="cc7c9b78">startTime</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="889e932f">Exposed</span>
     <li><span class="dfn-paneled" id="feb93a86">call a user object's operation</span>
     <li><span class="dfn-paneled" id="3ab7bf79">callback function</span>
     <li><span class="dfn-paneled" id="10ce5f6f">invoke</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-fetch">[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-hr-time-3">[HR-TIME-3]
   <dd>Yoav Weiss. <a href="https://w3c.github.io/hr-time/"><cite>High Resolution Time</cite></a>. URL: <a href="https://w3c.github.io/hr-time/">https://w3c.github.io/hr-time/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-largest-contentful-paint">[LARGEST-CONTENTFUL-PAINT]
   <dd>Yoav Weiss; Nicolas Pena Moreno. <a href="https://w3c.github.io/largest-contentful-paint/"><cite>Largest Contentful Paint</cite></a>. URL: <a href="https://w3c.github.io/largest-contentful-paint/">https://w3c.github.io/largest-contentful-paint/</a>
   <dt id="biblio-performance-timeline">[PERFORMANCE-TIMELINE]
   <dd>Nicolas Pena Moreno. <a href="https://w3c.github.io/performance-timeline/"><cite>Performance Timeline</cite></a>. URL: <a href="https://w3c.github.io/performance-timeline/">https://w3c.github.io/performance-timeline/</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#softnavigationentry"><code class="highlight"><c- g>SoftNavigationEntry</c-></code></a> : <a data-link-type="idl-name" href="https://w3c.github.io/performance-timeline/#dom-performanceentry"><c- n>PerformanceEntry</c-></a> {
};

</pre>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> May be this should be called in "prepare to run a callback"/"clean up after running a callback", but we’d need to pipe in the callback for that. <a class="issue-return" href="#issue-eae2392e" title="Jump to section">↵</a></div>
   <div class="issue"> May be we need to define registration semantics for everything that doesn’t need anything more specific. <a class="issue-return" href="#issue-83823d90" title="Jump to section">↵</a></div>
  </div>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
    const dfnsJson = window.dfnsJson || {};

    function genDfnPanel({dfnID, url, dfnText, refSections, external}) {
        return mk.aside({
            class: "dfn-panel",
            id: `infopanel-for-${dfnID}`,
            "data-for": dfnID,
            "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
            },
            mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
                `Info about the '${dfnText}' ${external?"external":""} reference.`),
            mk.a({href:url}, url),
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({
                                    href: `#${ref.id}`
                                    },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        );
    }

    function genAllDfnPanels() {
        for(const panelData of Object.values(window.dfnpanelData)) {
            const dfnID = panelData.dfnID;
            const dfn = document.getElementById(dfnID);
            if(!dfn) {
                console.log(`Can't find dfn#${dfnID}.`, panelData);
            } else {
                const panel = genDfnPanel(panelData);
                append(document.body, panel);
                insertDfnPopupAction(dfn, panel)
            }
        }
    }

    document.addEventListener("DOMContentLoaded", ()=>{
        genAllDfnPanels();

        // Add popup behavior to all dfns to show the corresponding dfn-panel.
        var dfns = queryAll('.dfn-paneled');
        for(let dfn of dfns) { ; }

        document.body.addEventListener("click", (e) => {
            // If not handled already, just hide all dfn panels.
            hideAllDfnPanels();
        });
    })


    function hideAllDfnPanels() {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>hideDfnPanel(el));
    }

    function showDfnPanel(dfnPanel, dfn) {
        hideAllDfnPanels(); // Only display one at this time.
        dfn.setAttribute("aria-expanded", "true");
        dfnPanel.classList.add("on");
        dfnPanel.style.left = "5px";
        dfnPanel.style.top = "0px";
        const panelRect = dfnPanel.getBoundingClientRect();
        const panelWidth = panelRect.right - panelRect.left;
        if (panelRect.right > document.body.scrollWidth) {
            // Panel's overflowing the screen.
            // Just drop it below the dfn and flip it rightward instead.
            // This still wont' fix things if the screen is *really* wide,
            // but fixing that's a lot harder without 'anchor()'.
            dfnPanel.style.top = "1.5em";
            dfnPanel.style.left = "auto";
            dfnPanel.style.right = "0px";
        }
    }

    function pinDfnPanel(dfnPanel) {
        // Switch it to "activated" state, which pins it.
        dfnPanel.classList.add("activated");
        dfnPanel.style.left = null;
        dfnPanel.style.top = null;
    }

    function hideDfnPanel(dfnPanel, dfn) {
        if(!dfn) {
            dfn = document.getElementById(dfnPanel.getAttribute("data-for"));
        }
        dfn.setAttribute("aria-expanded", "false")
        dfnPanel.classList.remove("on");
        dfnPanel.classList.remove("activated");
    }

    function toggleDfnPanel(dfnPanel, dfn) {
        if(dfnPanel.classList.contains("on")) {
            hideDfnPanel(dfnPanel, dfn);
        } else {
            showDfnPanel(dfnPanel, dfn);
        }
    }

    function insertDfnPopupAction(dfn, dfnPanel) {
        // Find dfn panel
        const panelWrapper = document.createElement('span');
        panelWrapper.appendChild(dfnPanel);
        panelWrapper.style.position = "relative";
        panelWrapper.style.height = "0px";
        dfn.insertAdjacentElement("afterend", panelWrapper);
        dfn.setAttribute('role', 'button');
        dfn.setAttribute('aria-expanded', 'false')
        dfn.tabIndex = 0;
        dfn.classList.add('has-dfn-panel');
        dfn.addEventListener('click', (event) => {
            showDfnPanel(dfnPanel, dfn);
            event.stopPropagation();
        });
        dfn.addEventListener('keypress', (event) => {
            const kc = event.keyCode;
            // 32->Space, 13->Enter
            if(kc == 32 || kc == 13) {
                toggleDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        });

        dfnPanel.addEventListener('click', (event) => {
            if (event.target.nodeName == 'A') {
                pinDfnPanel(dfnPanel);
            }
            event.stopPropagation();
        });

        dfnPanel.addEventListener('keydown', (event) => {
            if(event.keyCode == 27) { // Escape key
                hideDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        })
    }
}
</script>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
    const dfnsJson = window.dfnsJson || {};

    function genDfnPanel({dfnID, url, dfnText, refSections, external}) {
        return mk.aside({
            class: "dfn-panel",
            id: `infopanel-for-${dfnID}`,
            "data-for": dfnID,
            "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
            },
            mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
                `Info about the '${dfnText}' ${external?"external":""} reference.`),
            mk.a({href:url}, url),
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({
                                    href: `#${ref.id}`
                                    },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        );
    }

    function genAllDfnPanels() {
        for(const panelData of Object.values(window.dfnpanelData)) {
            const dfnID = panelData.dfnID;
            const dfn = document.getElementById(dfnID);
            if(!dfn) {
                console.log(`Can't find dfn#${dfnID}.`, panelData);
            } else {
                const panel = genDfnPanel(panelData);
                append(document.body, panel);
                insertDfnPopupAction(dfn, panel)
            }
        }
    }

    document.addEventListener("DOMContentLoaded", ()=>{
        genAllDfnPanels();

        // Add popup behavior to all dfns to show the corresponding dfn-panel.
        var dfns = queryAll('.dfn-paneled');
        for(let dfn of dfns) { ; }

        document.body.addEventListener("click", (e) => {
            // If not handled already, just hide all dfn panels.
            hideAllDfnPanels();
        });
    })


    function hideAllDfnPanels() {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>hideDfnPanel(el));
    }

    function showDfnPanel(dfnPanel, dfn) {
        hideAllDfnPanels(); // Only display one at this time.
        dfn.setAttribute("aria-expanded", "true");
        dfnPanel.classList.add("on");
        dfnPanel.style.left = "5px";
        dfnPanel.style.top = "0px";
        const panelRect = dfnPanel.getBoundingClientRect();
        const panelWidth = panelRect.right - panelRect.left;
        if (panelRect.right > document.body.scrollWidth) {
            // Panel's overflowing the screen.
            // Just drop it below the dfn and flip it rightward instead.
            // This still wont' fix things if the screen is *really* wide,
            // but fixing that's a lot harder without 'anchor()'.
            dfnPanel.style.top = "1.5em";
            dfnPanel.style.left = "auto";
            dfnPanel.style.right = "0px";
        }
    }

    function pinDfnPanel(dfnPanel) {
        // Switch it to "activated" state, which pins it.
        dfnPanel.classList.add("activated");
        dfnPanel.style.left = null;
        dfnPanel.style.top = null;
    }

    function hideDfnPanel(dfnPanel, dfn) {
        if(!dfn) {
            dfn = document.getElementById(dfnPanel.getAttribute("data-for"));
        }
        dfn.setAttribute("aria-expanded", "false")
        dfnPanel.classList.remove("on");
        dfnPanel.classList.remove("activated");
    }

    function toggleDfnPanel(dfnPanel, dfn) {
        if(dfnPanel.classList.contains("on")) {
            hideDfnPanel(dfnPanel, dfn);
        } else {
            showDfnPanel(dfnPanel, dfn);
        }
    }

    function insertDfnPopupAction(dfn, dfnPanel) {
        // Find dfn panel
        const panelWrapper = document.createElement('span');
        panelWrapper.appendChild(dfnPanel);
        panelWrapper.style.position = "relative";
        panelWrapper.style.height = "0px";
        dfn.insertAdjacentElement("afterend", panelWrapper);
        dfn.setAttribute('role', 'button');
        dfn.setAttribute('aria-expanded', 'false')
        dfn.tabIndex = 0;
        dfn.classList.add('has-dfn-panel');
        dfn.addEventListener('click', (event) => {
            showDfnPanel(dfnPanel, dfn);
            event.stopPropagation();
        });
        dfn.addEventListener('keypress', (event) => {
            const kc = event.keyCode;
            // 32->Space, 13->Enter
            if(kc == 32 || kc == 13) {
                toggleDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        });

        dfnPanel.addEventListener('click', (event) => {
            if (event.target.nodeName == 'A') {
                pinDfnPanel(dfnPanel);
            }
            event.stopPropagation();
        });

        dfnPanel.addEventListener('keydown', (event) => {
            if(event.keyCode == 27) { // Escape key
                hideDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        })
    }
}
</script>
<script>/* Boilerplate: script-dfn-panel-json */
window.dfnpanelData = {};
window.dfnpanelData['f0a4a2c5'] = {"dfnID": "f0a4a2c5", "url": "https://w3c.github.io/largest-contentful-paint/#has-dispatched-input-event", "dfnText": "has dispatched input event", "refSections": [{"refs": [{"id": "ref-for-has-dispatched-input-event"}], "title": "3.1. Soft navigation entry"}], "external": true};
window.dfnpanelData['ea3a4c2f'] = {"dfnID": "ea3a4c2f", "url": "https://w3c.github.io/largest-contentful-paint/#has-dispatched-scroll-event", "dfnText": "has dispatched scroll event", "refSections": [{"refs": [{"id": "ref-for-has-dispatched-scroll-event"}], "title": "3.1. Soft navigation entry"}], "external": true};
window.dfnpanelData['976def1b'] = {"dfnID": "976def1b", "url": "https://www.w3.org/TR/paint-timing/#previously-reported-paints", "dfnText": "previously reported paints", "refSections": [{"refs": [{"id": "ref-for-previously-reported-paints"}], "title": "3.1. Soft navigation entry"}], "external": true};
window.dfnpanelData['bb2c4ef9'] = {"dfnID": "bb2c4ef9", "url": "https://www.w3.org/TR/css-view-transitions-1/#dom-document-startviewtransition", "dfnText": "startviewtransition()", "refSections": [{"refs": [{"id": "ref-for-dom-document-startviewtransition"}], "title": "7.10. View transitions"}], "external": true};
window.dfnpanelData['2bc0cdf4'] = {"dfnID": "2bc0cdf4", "url": "https://dom.spec.whatwg.org/#eventtarget", "dfnText": "EventTarget", "refSections": [{"refs": [{"id": "ref-for-eventtarget"}], "title": "3.2. Interaction"}], "external": true};
window.dfnpanelData['a973e0fe'] = {"dfnID": "a973e0fe", "url": "https://dom.spec.whatwg.org/#concept-document", "dfnText": "document", "refSections": [{"refs": [{"id": "ref-for-concept-document"}], "title": "3. Algorithms"}, {"refs": [{"id": "ref-for-concept-document\u2460"}, {"id": "ref-for-concept-document\u2461"}], "title": "3.2. Interaction"}, {"refs": [{"id": "ref-for-concept-document\u2462"}], "title": "3.4. Contentful paint"}, {"refs": [{"id": "ref-for-concept-document\u2463"}, {"id": "ref-for-concept-document\u2464"}, {"id": "ref-for-concept-document\u2465"}, {"id": "ref-for-concept-document\u2466"}], "title": "4.1. Document"}], "external": true};
window.dfnpanelData['27d9b7ea'] = {"dfnID": "27d9b7ea", "url": "https://dom.spec.whatwg.org/#concept-element", "dfnText": "element", "refSections": [{"refs": [{"id": "ref-for-concept-element"}], "title": "3.4. Contentful paint"}], "external": true};
window.dfnpanelData['e9486b7f'] = {"dfnID": "e9486b7f", "url": "https://dom.spec.whatwg.org/#concept-node-equals", "dfnText": "equals", "refSections": [{"refs": [{"id": "ref-for-concept-node-equals"}, {"id": "ref-for-concept-node-equals\u2460"}, {"id": "ref-for-concept-node-equals\u2461"}, {"id": "ref-for-concept-node-equals\u2462"}], "title": "3.2. Interaction"}], "external": true};
window.dfnpanelData['4523ab1a'] = {"dfnID": "4523ab1a", "url": "https://dom.spec.whatwg.org/#concept-event-dispatch", "dfnText": "event dispatch", "refSections": [{"refs": [{"id": "ref-for-concept-event-dispatch"}, {"id": "ref-for-concept-event-dispatch\u2460"}], "title": "4.3. Event dispatch"}], "external": true};
window.dfnpanelData['b87df86e'] = {"dfnID": "b87df86e", "url": "https://dom.spec.whatwg.org/#dom-event-istrusted", "dfnText": "istrusted", "refSections": [{"refs": [{"id": "ref-for-dom-event-istrusted"}], "title": "4.3. Event dispatch"}], "external": true};
window.dfnpanelData['d462b34f'] = {"dfnID": "d462b34f", "url": "https://dom.spec.whatwg.org/#boundary-point-node", "dfnText": "node", "refSections": [{"refs": [{"id": "ref-for-boundary-point-node"}], "title": "4.4. Node"}], "external": true};
window.dfnpanelData['5216e1a0'] = {"dfnID": "5216e1a0", "url": "https://dom.spec.whatwg.org/#concept-node-document", "dfnText": "node document", "refSections": [{"refs": [{"id": "ref-for-concept-node-document"}], "title": "4.4. Node"}], "external": true};
window.dfnpanelData['59bfea49'] = {"dfnID": "59bfea49", "url": "https://dom.spec.whatwg.org/#concept-node-insert", "dfnText": "node insert", "refSections": [{"refs": [{"id": "ref-for-concept-node-insert"}], "title": "4.4. Node"}], "external": true};
window.dfnpanelData['d5434eef'] = {"dfnID": "d5434eef", "url": "https://fetch.spec.whatwg.org/#header-list-contains", "dfnText": "contains", "refSections": [{"refs": [{"id": "ref-for-header-list-contains"}], "title": "6.3. Is ancestor in set"}], "external": true};
window.dfnpanelData['0e9f636b'] = {"dfnID": "0e9f636b", "url": "https://w3c.github.io/hr-time/#dom-domhighrestimestamp", "dfnText": "DOMHighResTimeStamp", "refSections": [{"refs": [{"id": "ref-for-dom-domhighrestimestamp"}], "title": "3.1. Soft navigation entry"}], "external": true};
window.dfnpanelData['7e7cc1d8'] = {"dfnID": "7e7cc1d8", "url": "https://w3c.github.io/hr-time/#dfn-current-high-resolution-time", "dfnText": "current high resolution time", "refSections": [{"refs": [{"id": "ref-for-dfn-current-high-resolution-time"}], "title": "3.1. Soft navigation entry"}, {"refs": [{"id": "ref-for-dfn-current-high-resolution-time\u2460"}], "title": "3.2. Interaction"}], "external": true};
window.dfnpanelData['4b2c8c72'] = {"dfnID": "4b2c8c72", "url": "https://w3c.github.io/hr-time/#dfn-duration", "dfnText": "duration", "refSections": [{"refs": [{"id": "ref-for-dfn-duration"}], "title": "3.1. Soft navigation entry"}], "external": true};
window.dfnpanelData['af257a63'] = {"dfnID": "af257a63", "url": "https://html.spec.whatwg.org/C#tn-append-session-history-synchronous-navigation-steps", "dfnText": "append session history synchronous navigation steps", "refSections": [{"refs": [{"id": "ref-for-tn-append-session-history-synchronous-navigation-steps"}], "title": "7.9. Same-document navigations"}], "external": true};
window.dfnpanelData['e2ab0b9e'] = {"dfnID": "e2ab0b9e", "url": "https://html.spec.whatwg.org/C#tn-append-session-history-traversal-steps", "dfnText": "append session history traversal steps", "refSections": [{"refs": [{"id": "ref-for-tn-append-session-history-traversal-steps"}], "title": "7.9. Same-document navigations"}], "external": true};
window.dfnpanelData['019c28e2'] = {"dfnID": "019c28e2", "url": "https://html.spec.whatwg.org/C#apply-the-history-step", "dfnText": "apply the history step", "refSections": [{"refs": [{"id": "ref-for-apply-the-history-step"}], "title": "7.9. Same-document navigations"}], "external": true};
window.dfnpanelData['3349d69f'] = {"dfnID": "3349d69f", "url": "https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window", "dfnText": "associated document", "refSections": [{"refs": [{"id": "ref-for-concept-document-window"}], "title": "3.1. Soft navigation entry"}, {"refs": [{"id": "ref-for-concept-document-window\u2460"}], "title": "3.2. Interaction"}], "external": true};
window.dfnpanelData['d5ac3b38'] = {"dfnID": "d5ac3b38", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#clean-up-after-running-a-callback", "dfnText": "clean up after running a callback", "refSections": [{"refs": [{"id": "ref-for-clean-up-after-running-a-callback"}], "title": "7.6. Callbacks"}], "external": true};
window.dfnpanelData['c6d19e56'] = {"dfnID": "c6d19e56", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#event-loop", "dfnText": "event loop", "refSections": [{"refs": [{"id": "ref-for-event-loop"}], "title": "7.2. Event Loop additions"}], "external": true};
window.dfnpanelData['b78d6a64'] = {"dfnID": "b78d6a64", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-agent-event-loop", "dfnText": "event loop (for agent)", "refSections": [{"refs": [{"id": "ref-for-concept-agent-event-loop"}, {"id": "ref-for-concept-agent-event-loop\u2460"}], "title": "6.1. Task scope"}, {"refs": [{"id": "ref-for-concept-agent-event-loop\u2461"}], "title": "6.3.1. Get current task"}], "external": true};
window.dfnpanelData['9ed0e01d'] = {"dfnID": "9ed0e01d", "url": "https://html.spec.whatwg.org/C#execute-the-script-element", "dfnText": "execute the script element", "refSections": [{"refs": [{"id": "ref-for-execute-the-script-element"}], "title": "7.3. Script execution"}], "external": true};
window.dfnpanelData['4b6086d7'] = {"dfnID": "4b6086d7", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#global-object", "dfnText": "global object", "refSections": [{"refs": [{"id": "ref-for-global-object"}, {"id": "ref-for-global-object\u2460"}], "title": "3.1. Soft navigation entry"}], "external": true};
window.dfnpanelData['355696eb'] = {"dfnID": "355696eb", "url": "https://html.spec.whatwg.org/C#hostcalljobcallback", "dfnText": "hostcalljobcallback", "refSections": [{"refs": [{"id": "ref-for-hostcalljobcallback"}], "title": "7.7.2. HostCallJobCallback"}], "external": true};
window.dfnpanelData['d0010562'] = {"dfnID": "d0010562", "url": "https://html.spec.whatwg.org/C#hostmakejobcallback", "dfnText": "hostmakejobcallback", "refSections": [{"refs": [{"id": "ref-for-hostmakejobcallback"}], "title": "7.7.1. HostMakeJobCallback ##{#sec-hostmakejobcallback}"}], "external": true};
window.dfnpanelData['132c94e7'] = {"dfnID": "132c94e7", "url": "https://html.spec.whatwg.org/C#message-port-post-message-steps", "dfnText": "message port post message steps", "refSections": [{"refs": [{"id": "ref-for-message-port-post-message-steps"}], "title": "7.8. MessagePorts"}], "external": true};
window.dfnpanelData['887585a1'] = {"dfnID": "887585a1", "url": "https://html.spec.whatwg.org/C#navigate-fragid", "dfnText": "navigate to a fragment", "refSections": [{"refs": [{"id": "ref-for-navigate-fragid"}], "title": "7.9. Same-document navigations"}], "external": true};
window.dfnpanelData['5e31523c'] = {"dfnID": "5e31523c", "url": "https://html.spec.whatwg.org/C#prepare-the-script-element", "dfnText": "prepare the script element", "refSections": [{"refs": [{"id": "ref-for-prepare-the-script-element"}], "title": "7.3. Script execution"}], "external": true};
window.dfnpanelData['9a517a7d'] = {"dfnID": "9a517a7d", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task", "dfnText": "queue a task", "refSections": [{"refs": [{"id": "ref-for-queue-a-task"}], "title": "7.4. Task queueing"}], "external": true};
window.dfnpanelData['b75a7d23'] = {"dfnID": "b75a7d23", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-global-object-realm", "dfnText": "realm", "refSections": [{"refs": [{"id": "ref-for-concept-global-object-realm"}], "title": "3.1. Soft navigation entry"}], "external": true};
window.dfnpanelData['d8049b98'] = {"dfnID": "d8049b98", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#relevant-agent", "dfnText": "relevant agent", "refSections": [{"refs": [{"id": "ref-for-relevant-agent"}, {"id": "ref-for-relevant-agent\u2460"}], "title": "6.1. Task scope"}, {"refs": [{"id": "ref-for-relevant-agent\u2461"}], "title": "6.3.1. Get current task"}], "external": true};
window.dfnpanelData['e99bd18e'] = {"dfnID": "e99bd18e", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global", "dfnText": "relevant global object", "refSections": [{"refs": [{"id": "ref-for-concept-relevant-global"}], "title": "3. Algorithms"}, {"refs": [{"id": "ref-for-concept-relevant-global\u2460"}], "title": "3.2. Interaction"}], "external": true};
window.dfnpanelData['dd6462cb'] = {"dfnID": "dd6462cb", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-script", "dfnText": "script", "refSections": [{"refs": [{"id": "ref-for-concept-script"}], "title": "7.3. Script execution"}], "external": true};
window.dfnpanelData['770d6174'] = {"dfnID": "770d6174", "url": "https://html.spec.whatwg.org/C#she-url", "dfnText": "session history entry url", "refSections": [{"refs": [{"id": "ref-for-she-url"}], "title": "4.2. History"}], "external": true};
window.dfnpanelData['e270bd2a'] = {"dfnID": "e270bd2a", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#concept-task", "dfnText": "task", "refSections": [{"refs": [{"id": "ref-for-concept-task"}, {"id": "ref-for-concept-task\u2460"}, {"id": "ref-for-concept-task\u2461"}], "title": "6.1. Task scope"}, {"refs": [{"id": "ref-for-concept-task\u2462"}, {"id": "ref-for-concept-task\u2463"}, {"id": "ref-for-concept-task\u2464"}], "title": "7.1. Task additions"}, {"refs": [{"id": "ref-for-concept-task\u2465"}], "title": "7.3. Script execution"}, {"refs": [{"id": "ref-for-concept-task\u2466"}], "title": "7.6. Callbacks"}, {"refs": [{"id": "ref-for-concept-task\u2467"}], "title": "7.9. Same-document navigations"}], "external": true};
window.dfnpanelData['32301e7b'] = {"dfnID": "32301e7b", "url": "https://html.spec.whatwg.org/C#timer-initialisation-steps", "dfnText": "timer initialisation steps", "refSections": [{"refs": [{"id": "ref-for-timer-initialisation-steps"}], "title": "7.5. Timers"}], "external": true};
window.dfnpanelData['5fd199e1'] = {"dfnID": "5fd199e1", "url": "https://html.spec.whatwg.org/C#top-level-traversable", "dfnText": "top-level traversable", "refSections": [{"refs": [{"id": "ref-for-top-level-traversable"}], "title": "3.2. Interaction"}], "external": true};
window.dfnpanelData['d0c1b934'] = {"dfnID": "d0c1b934", "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#traversable-navigable", "dfnText": "traversable navigable", "refSections": [{"refs": [{"id": "ref-for-traversable-navigable"}], "title": "7.9. Same-document navigations"}], "external": true};
window.dfnpanelData['d0c5bc48'] = {"dfnID": "d0c5bc48", "url": "https://html.spec.whatwg.org/C#update-document-for-history-step-application", "dfnText": "update document for history step application", "refSections": [{"refs": [{"id": "ref-for-update-document-for-history-step-application"}], "title": "4.2. History"}, {"refs": [{"id": "ref-for-update-document-for-history-step-application\u2460"}, {"id": "ref-for-update-document-for-history-step-application\u2461"}], "title": "7.9. Same-document navigations"}], "external": true};
window.dfnpanelData['a3b18719'] = {"dfnID": "a3b18719", "url": "https://infra.spec.whatwg.org/#set-append", "dfnText": "append", "refSections": [{"refs": [{"id": "ref-for-set-append"}], "title": "3.2. Interaction"}], "external": true};
window.dfnpanelData['1243a891'] = {"dfnID": "1243a891", "url": "https://infra.spec.whatwg.org/#map-exists", "dfnText": "exist", "refSections": [{"refs": [{"id": "ref-for-map-exists"}, {"id": "ref-for-map-exists\u2460"}, {"id": "ref-for-map-exists\u2461"}], "title": "3.2. Interaction"}], "external": true};
window.dfnpanelData['860300d4'] = {"dfnID": "860300d4", "url": "https://infra.spec.whatwg.org/#implementation-defined", "dfnText": "implementation-defined", "refSections": [{"refs": [{"id": "ref-for-implementation-defined"}], "title": "6.1. Task scope"}, {"refs": [{"id": "ref-for-implementation-defined\u2460"}], "title": "7.1. Task additions"}], "external": true};
window.dfnpanelData['c88f3887'] = {"dfnID": "c88f3887", "url": "https://infra.spec.whatwg.org/#struct-item", "dfnText": "item", "refSections": [{"refs": [{"id": "ref-for-struct-item"}], "title": "3.2. Interaction"}], "external": true};
window.dfnpanelData['3fca5a9e'] = {"dfnID": "3fca5a9e", "url": "https://infra.spec.whatwg.org/#ordered-map", "dfnText": "map", "refSections": [{"refs": [{"id": "ref-for-ordered-map"}, {"id": "ref-for-ordered-map\u2460"}, {"id": "ref-for-ordered-map\u2461"}], "title": "3.1. Soft navigation entry"}, {"refs": [{"id": "ref-for-ordered-map\u2462"}, {"id": "ref-for-ordered-map\u2463"}], "title": "4.1. Document"}], "external": true};
window.dfnpanelData['a5ad1660'] = {"dfnID": "a5ad1660", "url": "https://infra.spec.whatwg.org/#stack-peek", "dfnText": "peek", "refSections": [{"refs": [{"id": "ref-for-stack-peek"}], "title": "6.3.1. Get current task"}], "external": true};
window.dfnpanelData['15e48c39'] = {"dfnID": "15e48c39", "url": "https://infra.spec.whatwg.org/#ordered-set", "dfnText": "set", "refSections": [{"refs": [{"id": "ref-for-ordered-set"}], "title": "3.1. Soft navigation entry"}, {"refs": [{"id": "ref-for-ordered-set\u2460"}], "title": "4.1. Document"}, {"refs": [{"id": "ref-for-ordered-set\u2461"}], "title": "6.3. Is ancestor in set"}], "external": true};
window.dfnpanelData['0e6b2056'] = {"dfnID": "0e6b2056", "url": "https://infra.spec.whatwg.org/#map-set", "dfnText": "set (for map)", "refSections": [{"refs": [{"id": "ref-for-map-set"}, {"id": "ref-for-map-set\u2460"}], "title": "3.2. Interaction"}, {"refs": [{"id": "ref-for-map-set\u2461"}, {"id": "ref-for-map-set\u2462"}], "title": "3.3. Same document commit"}], "external": true};
window.dfnpanelData['ceacaa1c'] = {"dfnID": "ceacaa1c", "url": "https://infra.spec.whatwg.org/#stack", "dfnText": "stack", "refSections": [{"refs": [{"id": "ref-for-stack"}], "title": "7.2. Event Loop additions"}], "external": true};
window.dfnpanelData['0698d556'] = {"dfnID": "0698d556", "url": "https://infra.spec.whatwg.org/#string", "dfnText": "string", "refSections": [{"refs": [{"id": "ref-for-string"}], "title": "3.1. Soft navigation entry"}, {"refs": [{"id": "ref-for-string\u2460"}], "title": "3.2. Interaction"}, {"refs": [{"id": "ref-for-string\u2461"}], "title": "3.3. Same document commit"}], "external": true};
window.dfnpanelData['984221ca'] = {"dfnID": "984221ca", "url": "https://infra.spec.whatwg.org/#struct", "dfnText": "struct", "refSections": [{"refs": [{"id": "ref-for-struct"}], "title": "3.2. Interaction"}], "external": true};
window.dfnpanelData['984cff1a'] = {"dfnID": "984cff1a", "url": "https://w3c.github.io/largest-contentful-paint/#potentially-add-a-largestcontentfulpaint-entry", "dfnText": "potentially add a largestcontentfulpaint entry", "refSections": [{"refs": [{"id": "ref-for-potentially-add-a-largestcontentfulpaint-entry"}], "title": "5. LCP integration"}], "external": true};
window.dfnpanelData['a7f8f241'] = {"dfnID": "a7f8f241", "url": "https://w3c.github.io/performance-timeline/#dom-performanceentry", "dfnText": "PerformanceEntry", "refSections": [{"refs": [{"id": "ref-for-dom-performanceentry"}], "title": "2. The SoftNavigationEntry interface"}], "external": true};
window.dfnpanelData['fabd3046'] = {"dfnID": "fabd3046", "url": "https://w3c.github.io/performance-timeline/#dom-performanceentry-duration", "dfnText": "duration", "refSections": [{"refs": [{"id": "ref-for-dom-performanceentry-duration"}], "title": "3.1. Soft navigation entry"}], "external": true};
window.dfnpanelData['08a90f22'] = {"dfnID": "08a90f22", "url": "https://w3c.github.io/performance-timeline/#dom-performanceentry-entrytype", "dfnText": "entryType", "refSections": [{"refs": [{"id": "ref-for-dom-performanceentry-entrytype"}], "title": "3.1. Soft navigation entry"}], "external": true};
window.dfnpanelData['09c54b53'] = {"dfnID": "09c54b53", "url": "https://w3c.github.io/performance-timeline/#dom-performanceentry-name", "dfnText": "name", "refSections": [{"refs": [{"id": "ref-for-dom-performanceentry-name"}], "title": "3.1. Soft navigation entry"}], "external": true};
window.dfnpanelData['d52ccb4e'] = {"dfnID": "d52ccb4e", "url": "https://w3c.github.io/performance-timeline/#dfn-performance-entry-buffer", "dfnText": "performance entry buffer", "refSections": [{"refs": [{"id": "ref-for-dfn-performance-entry-buffer"}], "title": "3.1. Soft navigation entry"}], "external": true};
window.dfnpanelData['a9ea380f'] = {"dfnID": "a9ea380f", "url": "https://w3c.github.io/performance-timeline/#dfn-queue-a-performanceentry", "dfnText": "queue a performanceentry", "refSections": [{"refs": [{"id": "ref-for-dfn-queue-a-performanceentry"}, {"id": "ref-for-dfn-queue-a-performanceentry\u2460"}], "title": "3.1. Soft navigation entry"}], "external": true};
window.dfnpanelData['cc7c9b78'] = {"dfnID": "cc7c9b78", "url": "https://w3c.github.io/performance-timeline/#dom-performanceentry-starttime", "dfnText": "startTime", "refSections": [{"refs": [{"id": "ref-for-dom-performanceentry-starttime"}], "title": "3.1. Soft navigation entry"}], "external": true};
window.dfnpanelData['889e932f'] = {"dfnID": "889e932f", "url": "https://webidl.spec.whatwg.org/#Exposed", "dfnText": "Exposed", "refSections": [{"refs": [{"id": "ref-for-Exposed"}], "title": "2. The SoftNavigationEntry interface"}], "external": true};
window.dfnpanelData['feb93a86'] = {"dfnID": "feb93a86", "url": "https://webidl.spec.whatwg.org/#call-a-user-objects-operation", "dfnText": "call a user object's operation", "refSections": [{"refs": [{"id": "ref-for-call-a-user-objects-operation"}], "title": "7.6. Callbacks"}], "external": true};
window.dfnpanelData['3ab7bf79'] = {"dfnID": "3ab7bf79", "url": "https://webidl.spec.whatwg.org/#dfn-callback-function", "dfnText": "callback function", "refSections": [{"refs": [{"id": "ref-for-dfn-callback-function"}], "title": "7.6. Callbacks"}], "external": true};
window.dfnpanelData['10ce5f6f'] = {"dfnID": "10ce5f6f", "url": "https://webidl.spec.whatwg.org/#invoke-a-callback-function", "dfnText": "invoke", "refSections": [{"refs": [{"id": "ref-for-invoke-a-callback-function"}], "title": "7.6. Callbacks"}], "external": true};
window.dfnpanelData['softnavigationentry'] = {"dfnID": "softnavigationentry", "url": "#softnavigationentry", "dfnText": "SoftNavigationEntry", "refSections": [{"refs": [{"id": "ref-for-softnavigationentry"}, {"id": "ref-for-softnavigationentry\u2460"}], "title": "3.1. Soft navigation entry"}], "external": false};
window.dfnpanelData['check-soft-navigation'] = {"dfnID": "check-soft-navigation", "url": "#check-soft-navigation", "dfnText": "check soft navigation", "refSections": [{"refs": [{"id": "ref-for-check-soft-navigation"}], "title": "3.3. Same document commit"}, {"refs": [{"id": "ref-for-check-soft-navigation\u2460"}], "title": "3.4. Contentful paint"}], "external": false};
window.dfnpanelData['create-a-soft-navigation-entry'] = {"dfnID": "create-a-soft-navigation-entry", "url": "#create-a-soft-navigation-entry", "dfnText": "create a soft navigation entry", "refSections": [{"refs": [{"id": "ref-for-create-a-soft-navigation-entry"}], "title": "3. Algorithms"}], "external": false};
window.dfnpanelData['emit-soft-navigation-entry'] = {"dfnID": "emit-soft-navigation-entry", "url": "#emit-soft-navigation-entry", "dfnText": "emit soft navigation entry", "refSections": [{"refs": [{"id": "ref-for-emit-soft-navigation-entry"}], "title": "3. Algorithms"}], "external": false};
window.dfnpanelData['interaction-data'] = {"dfnID": "interaction-data", "url": "#interaction-data", "dfnText": "Interaction data", "refSections": [{"refs": [{"id": "ref-for-interaction-data"}, {"id": "ref-for-interaction-data\u2460"}], "title": "3.2. Interaction"}], "external": false};
window.dfnpanelData['interaction-data-url'] = {"dfnID": "interaction-data-url", "url": "#interaction-data-url", "dfnText": "url", "refSections": [{"refs": [{"id": "ref-for-interaction-data-url"}], "title": "3. Algorithms"}, {"refs": [{"id": "ref-for-interaction-data-url\u2460"}], "title": "3.3. Same document commit"}], "external": false};
window.dfnpanelData['interaction-data-start-time'] = {"dfnID": "interaction-data-start-time", "url": "#interaction-data-start-time", "dfnText": "start time", "refSections": [{"refs": [{"id": "ref-for-interaction-data-start-time"}], "title": "3. Algorithms"}, {"refs": [{"id": "ref-for-interaction-data-start-time\u2460"}], "title": "3.2. Interaction"}], "external": false};
window.dfnpanelData['interaction-data-same-document-commit'] = {"dfnID": "interaction-data-same-document-commit", "url": "#interaction-data-same-document-commit", "dfnText": "same document commit", "refSections": [{"refs": [{"id": "ref-for-interaction-data-same-document-commit"}], "title": "3. Algorithms"}, {"refs": [{"id": "ref-for-interaction-data-same-document-commit\u2460"}], "title": "3.3. Same document commit"}], "external": false};
window.dfnpanelData['interaction-data-contentful-paint'] = {"dfnID": "interaction-data-contentful-paint", "url": "#interaction-data-contentful-paint", "dfnText": "contentful paint", "refSections": [{"refs": [{"id": "ref-for-interaction-data-contentful-paint"}], "title": "3. Algorithms"}, {"refs": [{"id": "ref-for-interaction-data-contentful-paint\u2460"}], "title": "3.4. Contentful paint"}], "external": false};
window.dfnpanelData['get-current-interaction-data'] = {"dfnID": "get-current-interaction-data", "url": "#get-current-interaction-data", "dfnText": "get current interaction data", "refSections": [{"refs": [{"id": "ref-for-get-current-interaction-data"}], "title": "3. Algorithms"}, {"refs": [{"id": "ref-for-get-current-interaction-data\u2460"}], "title": "3.3. Same document commit"}, {"refs": [{"id": "ref-for-get-current-interaction-data\u2461"}], "title": "3.4. Contentful paint"}], "external": false};
window.dfnpanelData['handle-event-callback'] = {"dfnID": "handle-event-callback", "url": "#handle-event-callback", "dfnText": "handle event callback", "refSections": [{"refs": [{"id": "ref-for-handle-event-callback"}], "title": "4.3. Event dispatch"}], "external": false};
window.dfnpanelData['terminate-event-callback-handling'] = {"dfnID": "terminate-event-callback-handling", "url": "#terminate-event-callback-handling", "dfnText": "terminate event callback handling", "refSections": [{"refs": [{"id": "ref-for-terminate-event-callback-handling"}], "title": "4.3. Event dispatch"}], "external": false};
window.dfnpanelData['check-soft-navigation-same-document-commit'] = {"dfnID": "check-soft-navigation-same-document-commit", "url": "#check-soft-navigation-same-document-commit", "dfnText": "check soft navigation same document commit", "refSections": [{"refs": [{"id": "ref-for-check-soft-navigation-same-document-commit"}], "title": "4.2. History"}], "external": false};
window.dfnpanelData['check-soft-navigation-contentful-paint'] = {"dfnID": "check-soft-navigation-contentful-paint", "url": "#check-soft-navigation-contentful-paint", "dfnText": "check soft navigation contentful paint", "refSections": [{"refs": [{"id": "ref-for-check-soft-navigation-contentful-paint"}], "title": "5. LCP integration"}], "external": false};
window.dfnpanelData['document-potential-soft-navigation-task-ids'] = {"dfnID": "document-potential-soft-navigation-task-ids", "url": "#document-potential-soft-navigation-task-ids", "dfnText": "potential soft navigation task ids", "refSections": [{"refs": [{"id": "ref-for-document-potential-soft-navigation-task-ids"}], "title": "3.2. Interaction"}, {"refs": [{"id": "ref-for-document-potential-soft-navigation-task-ids\u2460"}], "title": "3.3. Same document commit"}, {"refs": [{"id": "ref-for-document-potential-soft-navigation-task-ids\u2461"}], "title": "4.4. Node"}], "external": false};
window.dfnpanelData['document-interaction-task-id-to-interaction-data'] = {"dfnID": "document-interaction-task-id-to-interaction-data", "url": "#document-interaction-task-id-to-interaction-data", "dfnText": "interaction task id to interaction data", "refSections": [{"refs": [{"id": "ref-for-document-interaction-task-id-to-interaction-data"}], "title": "3.1. Soft navigation entry"}, {"refs": [{"id": "ref-for-document-interaction-task-id-to-interaction-data\u2460"}, {"id": "ref-for-document-interaction-task-id-to-interaction-data\u2461"}, {"id": "ref-for-document-interaction-task-id-to-interaction-data\u2462"}, {"id": "ref-for-document-interaction-task-id-to-interaction-data\u2463"}], "title": "3.2. Interaction"}], "external": false};
window.dfnpanelData['document-task-id-to-interaction-task-id'] = {"dfnID": "document-task-id-to-interaction-task-id", "url": "#document-task-id-to-interaction-task-id", "dfnText": "task id to interaction task id", "refSections": [{"refs": [{"id": "ref-for-document-task-id-to-interaction-task-id"}], "title": "3.1. Soft navigation entry"}, {"refs": [{"id": "ref-for-document-task-id-to-interaction-task-id\u2460"}, {"id": "ref-for-document-task-id-to-interaction-task-id\u2461"}], "title": "3.2. Interaction"}], "external": false};
window.dfnpanelData['document-last-interaction-task-id'] = {"dfnID": "document-last-interaction-task-id", "url": "#document-last-interaction-task-id", "dfnText": "last interaction task id", "refSections": [{"refs": [{"id": "ref-for-document-last-interaction-task-id"}], "title": "3.1. Soft navigation entry"}, {"refs": [{"id": "ref-for-document-last-interaction-task-id\u2460"}], "title": "3.2. Interaction"}], "external": false};
window.dfnpanelData['node-appended-by-soft-navigation'] = {"dfnID": "node-appended-by-soft-navigation", "url": "#node-appended-by-soft-navigation", "dfnText": "appended by soft navigation", "refSections": [{"refs": [{"id": "ref-for-node-appended-by-soft-navigation"}], "title": "3.4. Contentful paint"}, {"refs": [{"id": "ref-for-node-appended-by-soft-navigation\u2460"}], "title": "4.4. Node"}], "external": false};
window.dfnpanelData['concept-task-scope'] = {"dfnID": "concept-task-scope", "url": "#concept-task-scope", "dfnText": "task scope", "refSections": [{"refs": [{"id": "ref-for-concept-task-scope"}, {"id": "ref-for-concept-task-scope\u2460"}], "title": "6.1. Task scope"}, {"refs": [{"id": "ref-for-concept-task-scope\u2461"}], "title": "7.2. Event Loop additions"}], "external": false};
window.dfnpanelData['task-scope-task'] = {"dfnID": "task-scope-task", "url": "#task-scope-task", "dfnText": "task", "refSections": [{"refs": [{"id": "ref-for-task-scope-task"}], "title": "6.1. Task scope"}, {"refs": [{"id": "ref-for-task-scope-task\u2460"}], "title": "6.3.1. Get current task"}], "external": false};
window.dfnpanelData['create-a-task-scope'] = {"dfnID": "create-a-task-scope", "url": "#create-a-task-scope", "dfnText": "create a task scope", "refSections": [{"refs": [{"id": "ref-for-create-a-task-scope"}], "title": "7.3. Script execution"}, {"refs": [{"id": "ref-for-create-a-task-scope\u2460"}], "title": "7.4. Task queueing"}, {"refs": [{"id": "ref-for-create-a-task-scope\u2461"}], "title": "7.5. Timers"}, {"refs": [{"id": "ref-for-create-a-task-scope\u2462"}, {"id": "ref-for-create-a-task-scope\u2463"}], "title": "7.6. Callbacks"}, {"refs": [{"id": "ref-for-create-a-task-scope\u2464"}], "title": "7.7.2. HostCallJobCallback"}, {"refs": [{"id": "ref-for-create-a-task-scope\u2465"}, {"id": "ref-for-create-a-task-scope\u2466"}], "title": "7.8. MessagePorts"}, {"refs": [{"id": "ref-for-create-a-task-scope\u2467"}], "title": "7.9. Same-document navigations"}], "external": false};
window.dfnpanelData['tear-down-a-task-scope'] = {"dfnID": "tear-down-a-task-scope", "url": "#tear-down-a-task-scope", "dfnText": "tear down a task scope", "refSections": [{"refs": [{"id": "ref-for-tear-down-a-task-scope"}], "title": "7.3. Script execution"}, {"refs": [{"id": "ref-for-tear-down-a-task-scope\u2460"}], "title": "7.4. Task queueing"}, {"refs": [{"id": "ref-for-tear-down-a-task-scope\u2461"}, {"id": "ref-for-tear-down-a-task-scope\u2462"}, {"id": "ref-for-tear-down-a-task-scope\u2463"}], "title": "7.6. Callbacks"}, {"refs": [{"id": "ref-for-tear-down-a-task-scope\u2464"}], "title": "7.7.2. HostCallJobCallback"}, {"refs": [{"id": "ref-for-tear-down-a-task-scope\u2465"}, {"id": "ref-for-tear-down-a-task-scope\u2466"}], "title": "7.8. MessagePorts"}, {"refs": [{"id": "ref-for-tear-down-a-task-scope\u2467"}], "title": "7.9. Same-document navigations"}], "external": false};
window.dfnpanelData['check-ancestor-for-task'] = {"dfnID": "check-ancestor-for-task", "url": "#check-ancestor-for-task", "dfnText": "check ancestor for task", "refSections": [{"refs": [{"id": "ref-for-check-ancestor-for-task"}], "title": "4.4. Node"}], "external": false};
window.dfnpanelData['check-ancestor-set-for-task'] = {"dfnID": "check-ancestor-set-for-task", "url": "#check-ancestor-set-for-task", "dfnText": "check ancestor set for task", "refSections": [{"refs": [{"id": "ref-for-check-ancestor-set-for-task"}], "title": "3.3. Same document commit"}], "external": false};
window.dfnpanelData['get-current-task'] = {"dfnID": "get-current-task", "url": "#get-current-task", "dfnText": "get current task", "refSections": [{"refs": [{"id": "ref-for-get-current-task"}], "title": "6.2. Is ancestor"}, {"refs": [{"id": "ref-for-get-current-task\u2460"}], "title": "6.3. Is ancestor in set"}, {"refs": [{"id": "ref-for-get-current-task\u2461"}], "title": "6.3.2. Get current task ID"}, {"refs": [{"id": "ref-for-get-current-task\u2462"}], "title": "7.3. Script execution"}, {"refs": [{"id": "ref-for-get-current-task\u2463"}], "title": "7.4. Task queueing"}, {"refs": [{"id": "ref-for-get-current-task\u2464"}], "title": "7.5. Timers"}, {"refs": [{"id": "ref-for-get-current-task\u2465"}], "title": "7.7.1. HostMakeJobCallback ##{#sec-hostmakejobcallback}"}, {"refs": [{"id": "ref-for-get-current-task\u2466"}], "title": "7.8. MessagePorts"}, {"refs": [{"id": "ref-for-get-current-task\u2467"}, {"id": "ref-for-get-current-task\u2468"}, {"id": "ref-for-get-current-task\u2460\u24ea"}], "title": "7.9. Same-document navigations"}, {"refs": [{"id": "ref-for-get-current-task\u2460\u2460"}], "title": "7.10. View transitions"}], "external": false};
window.dfnpanelData['get-current-task-id'] = {"dfnID": "get-current-task-id", "url": "#get-current-task-id", "dfnText": "get current task id", "refSections": [{"refs": [{"id": "ref-for-get-current-task-id"}, {"id": "ref-for-get-current-task-id\u2460"}], "title": "3.2. Interaction"}, {"refs": [{"id": "ref-for-get-current-task-id\u2461"}], "title": "4.4. Node"}], "external": false};
window.dfnpanelData['task-task-attribution-id'] = {"dfnID": "task-task-attribution-id", "url": "#task-task-attribution-id", "dfnText": "task attribution ID", "refSections": [{"refs": [{"id": "ref-for-task-task-attribution-id"}, {"id": "ref-for-task-task-attribution-id\u2460"}], "title": "4.1. Document"}, {"refs": [{"id": "ref-for-task-task-attribution-id\u2461"}], "title": "6.1. Task scope"}, {"refs": [{"id": "ref-for-task-task-attribution-id\u2462"}, {"id": "ref-for-task-task-attribution-id\u2463"}], "title": "6.2. Is ancestor"}, {"refs": [{"id": "ref-for-task-task-attribution-id\u2464"}, {"id": "ref-for-task-task-attribution-id\u2465"}], "title": "6.3. Is ancestor in set"}, {"refs": [{"id": "ref-for-task-task-attribution-id\u2466"}], "title": "6.3.2. Get current task ID"}], "external": false};
window.dfnpanelData['task-parent-task'] = {"dfnID": "task-parent-task", "url": "#task-parent-task", "dfnText": "parent task", "refSections": [{"refs": [{"id": "ref-for-task-parent-task"}], "title": "6.1. Task scope"}, {"refs": [{"id": "ref-for-task-parent-task\u2460"}], "title": "6.2. Is ancestor"}, {"refs": [{"id": "ref-for-task-parent-task\u2461"}], "title": "6.3. Is ancestor in set"}, {"refs": [{"id": "ref-for-task-parent-task\u2462"}], "title": "7.4. Task queueing"}], "external": false};
window.dfnpanelData['task-scope-stack'] = {"dfnID": "task-scope-stack", "url": "#task-scope-stack", "dfnText": "task scope stack", "refSections": [{"refs": [{"id": "ref-for-task-scope-stack"}, {"id": "ref-for-task-scope-stack\u2460"}], "title": "6.1. Task scope"}, {"refs": [{"id": "ref-for-task-scope-stack\u2461"}], "title": "6.3.1. Get current task"}], "external": false};
window.dfnpanelData['script-parent-task'] = {"dfnID": "script-parent-task", "url": "#script-parent-task", "dfnText": "parent task", "refSections": [{"refs": [{"id": "ref-for-script-parent-task"}, {"id": "ref-for-script-parent-task\u2460"}], "title": "7.3. Script execution"}], "external": false};
window.dfnpanelData['callback-function-parent-task'] = {"dfnID": "callback-function-parent-task", "url": "#callback-function-parent-task", "dfnText": "parent task", "refSections": [{"refs": [{"id": "ref-for-callback-function-parent-task"}], "title": "7.5. Timers"}, {"refs": [{"id": "ref-for-callback-function-parent-task\u2460"}, {"id": "ref-for-callback-function-parent-task\u2461"}], "title": "7.6. Callbacks"}, {"refs": [{"id": "ref-for-callback-function-parent-task\u2462"}], "title": "7.7.2. HostCallJobCallback"}, {"refs": [{"id": "ref-for-callback-function-parent-task\u2463"}], "title": "7.10. View transitions"}], "external": false};
window.dfnpanelData['navigation-task'] = {"dfnID": "navigation-task", "url": "#navigation-task", "dfnText": "navigation task", "refSections": [{"refs": [{"id": "ref-for-navigation-task"}, {"id": "ref-for-navigation-task\u2460"}], "title": "7.9. Same-document navigations"}], "external": false};
</script>
<script>/* Boilerplate: script-dom-helper */
function query(sel) { return document.querySelector(sel); }

function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

function iter(obj) {
	if(!obj) return [];
	var it = obj[Symbol.iterator];
	if(it) return it;
	return Object.entries(obj);
}

function mk(tagname, attrs, ...children) {
	const el = document.createElement(tagname);
	for(const [k,v] of iter(attrs)) {
		if(k.slice(0,3) == "_on") {
			const eventName = k.slice(3);
			el.addEventListener(eventName, v);
		} else if(k[0] == "_") {
			// property, not attribute
			el[k.slice(1)] = v;
		} else {
			if(v === false || v == null) {
        continue;
      } else if(v === true) {
        el.setAttribute(k, "");
        continue;
      } else {
  			el.setAttribute(k, v);
      }
		}
	}
	append(el, children);
	return el;
}

/* Create shortcuts for every known HTML element */
[
  "a",
  "abbr",
  "acronym",
  "address",
  "applet",
  "area",
  "article",
  "aside",
  "audio",
  "b",
  "base",
  "basefont",
  "bdo",
  "big",
  "blockquote",
  "body",
  "br",
  "button",
  "canvas",
  "caption",
  "center",
  "cite",
  "code",
  "col",
  "colgroup",
  "datalist",
  "dd",
  "del",
  "details",
  "dfn",
  "dialog",
  "div",
  "dl",
  "dt",
  "em",
  "embed",
  "fieldset",
  "figcaption",
  "figure",
  "font",
  "footer",
  "form",
  "frame",
  "frameset",
  "head",
  "header",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "hr",
  "html",
  "i",
  "iframe",
  "img",
  "input",
  "ins",
  "kbd",
  "label",
  "legend",
  "li",
  "link",
  "main",
  "map",
  "mark",
  "meta",
  "meter",
  "nav",
  "nobr",
  "noscript",
  "object",
  "ol",
  "optgroup",
  "option",
  "output",
  "p",
  "param",
  "pre",
  "progress",
  "q",
  "s",
  "samp",
  "script",
  "section",
  "select",
  "small",
  "source",
  "span",
  "strike",
  "strong",
  "style",
  "sub",
  "summary",
  "sup",
  "table",
  "tbody",
  "td",
  "template",
  "textarea",
  "tfoot",
  "th",
  "thead",
  "time",
  "title",
  "tr",
  "u",
  "ul",
  "var",
  "video",
  "wbr",
  "xmp",
].forEach(tagname=>{
	mk[tagname] = (...args) => mk(tagname, ...args);
});

function* nodesFromChildList(children) {
	for(const child of children.flat(Infinity)) {
		if(child instanceof Node) {
			yield child;
		} else {
			yield new Text(child);
		}
	}
}
function append(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		if(el instanceof Node) el.appendChild(child);
		else el.push(child);
	}
	return el;
}

function insertAfter(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		el.parentNode.insertBefore(child, el.nextSibling);
	}
	return el;
}

function clearContents(el) {
	el.innerHTML = "";
	return el;
}

function parseHTML(markup) {
	if(markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
		const doc = document.implementation.createHTMLDocument("");
		doc.documentElement.innerHTML = markup;
		return doc;
	} else {
		const el = mk.template({});
		el.innerHTML = markup;
		return el.content;
	}
}
</script>